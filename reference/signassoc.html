<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Statistical significance of species site-group associations — signassoc • indicspecies</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Statistical significance of species site-group associations — signassoc"><meta property="og:description" content="This function computes the permutation p-value of the association between a species vector and a vector of memberships to a site-group. Four different tests of hypotheses arise from considering either presence/absence or quantitative species data, and from using a non-equalized or group-equalized approach."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">indicspecies</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/IndicatorSpeciesAnalysis.html">Indicator Species Analysis using 'indicspecies'</a>
    </li>
    <li>
      <a href="../articles/PigeonExample.html">Usage of the niche metric functions (former 'resniche' package)</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Statistical significance of species site-group associations</h1>
    
    <div class="hidden name"><code>signassoc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function computes the permutation p-value of the association between a species vector and a vector of memberships to a site-group. Four different tests of hypotheses arise from considering either presence/absence or quantitative species data, and from using a non-equalized or group-equalized approach.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">signassoc</span><span class="op">(</span><span class="va">X</span>, U <span class="op">=</span> <span class="cn">NULL</span>, cluster <span class="op">=</span> <span class="cn">NULL</span>, mode <span class="op">=</span> <span class="fl">1</span>, alternative <span class="op">=</span> <span class="st">"greater"</span>, 
          control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span><span class="op">)</span>, permutations <span class="op">=</span> <span class="cn">NULL</span>, print.perm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>X</dt>
<dd><p>species data (rows are sites, columns are species).</p></dd>
<dt>U</dt>
<dd><p>A matrix of group memberships. Each column corresponds to one site-group. Membership values can be crisp or fuzzy. If this matrix is not provided, vector gmv will be used.</p></dd>
<dt>cluster</dt>
<dd><p>a vector of numeric group labels for the sites.</p></dd>
<dt>mode</dt>
<dd><p>0 (site-based) or 1 (group-based).</p></dd>
<dt>alternative</dt>
<dd><p>Alternative hypothesis: "greater" (positive association), "less" (negative association), "two.sided" (either positive or negative).</p></dd>
<dt>control</dt>
<dd><p>a list of control values describing properties of the permutation design, as returned by a call to <code>how</code>.</p></dd>
<dt>permutations</dt>
<dd><p>a custom matrix of permutations, to be used if <code>control = NULL</code>, with permutations in rows and site indices in columns.</p></dd>
<dt>print.perm</dt>
<dd><p>If TRUE, prints permutation numbers after each set of 100 permutations.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Input data for this function is the species matrix X and either a matrix of group memberships (U) or a vector of numeric group labels (cluster). This R function works for both presence/absence and quantitative species data, depending on the values of the input matrix X.
If <code>mode = 0</code>, the null ecological hypothesis is that the frequency (or abundance) of the species of interest in sites belonging to the site group is not higher than the frequency (or abundance) in sites not belonging to it. If <code>mode = 1</code>, the null ecological hypothesis is that the relative frequency (average abundance) of the species of interest is not higher in the target site group than in other groups. See De Cáceres and Legendre for more details.</p>
<p>Complex permutation designs are allowed through the function <code>how</code> from package "permute". If those are not enough, the user can set <code>control = NULL</code> and specify a custom matrix of permutations to test with parameter <code>permutations</code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a matrix of p-values, where species are in rows and groups are in columns. Two additional columns indicate the group with lowest p-value and the p-value for this group after Sidak's correction for multiple testing.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Users should be aware that the significance test in <code>signassoc</code> is not exactly the same as the one in <code>indval</code> from <code>labdsv</code> package. The <code>signassoc</code> function is using the preference for the target group (either non-equalized or group-equalized) as test statistic. After every permutation the preference for the target group is recalculated. The function is therefore testing the null hypothesis stating that the preference of the species for a given site group is due to chance only (as in Bakker 2008). The test is repeated for every group, and this is the reason why there are as many p-values as groups. In contrast, the <code>indval</code> function from <code>labdsv</code> package uses the maximum preference value as test statistic, and the maximum preference value is recalculated after each permutation. The maximum preference may correspond to other groups than the one chosen for the unpermuted data. <code>indval</code> function from <code>labdsv</code> package is therefore testing the null hypothesis saying that the group with observed maximum preference is not such, because the maximum preference was in that group due to chance only. In order to get the consistent results compared to the <code>indval</code> function, users should use the function <code><a href="multipatt.html">multipatt</a></code>, along with the option <code>duleg=TRUE</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Bakker, J. 2008. Increasing the utility of Indicator Species Analysis. Journal of Applied Ecology 45: 1829-1835.</p>
<p>De Cáceres, M. and Legendre, P. 2009. Associations between species and groups of sites: indices and statistical inference. Ecology 90(12): 3566-3574.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Miquel De Cáceres Ainsa,  CTFC</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="strassoc.html">strassoc</a></code>, <code><a href="multipatt.html">multipatt</a></code>, <code>how</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wetland</span><span class="op">)</span> <span class="co">## Load species data</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">wetkm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">wetland</span>, centers<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="co">## Create three clusters using</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Look for species whose abundance is significantly higher in one of the three groups</span></span>
<span class="r-in"><span class="fu">signassoc</span><span class="op">(</span><span class="va">wetland</span>, cluster<span class="op">=</span><span class="va">wetkm</span><span class="op">$</span><span class="va">cluster</span>, mode<span class="op">=</span><span class="fl">1</span>, control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span>nperm<span class="op">=</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            1     2     3 best      psidak</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Abefic 0.226 1.000 1.000    1 0.536315176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merhed 0.005 1.000 1.000    1 0.014925125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alyvag 1.000 0.033 1.000    2 0.095768937</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pancam 0.001 0.838 1.000    1 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Abemos 0.429 0.569 1.000    1 0.813830589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Melcor 0.001 0.540 1.000    1 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ludoct 0.276 1.000 1.000    1 0.620496576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eupvac 0.002 0.889 0.997    1 0.005988008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Echpas 0.377 0.451 0.859    1 0.758195633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Passcr 0.232 1.000 1.000    1 0.547015168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Poa2   1.000 0.337 1.000    2 0.708565753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Carhal 1.000 0.088 0.578    2 0.241449472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dendio 1.000 1.000 0.409    3 0.793574929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Casobt 1.000 1.000 0.445    3 0.829046125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aesind 0.830 0.015 1.000    2 0.044328375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cyprot 0.046 0.485 1.000    1 0.131749336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ipocop 0.148 0.741 1.000    1 0.381529792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cynarc 0.001 0.977 1.000    1 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Walind 0.419 0.511 0.533    1 0.803877059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sessp. 0.215 0.829 0.449    1 0.516263375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Phynod 0.994 0.001 1.000    2 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Echell 0.344 0.206 0.946    2 0.499433816</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Helind 0.999 0.003 0.388    2 0.008973027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ipoaqu 0.683 0.418 0.389    3 0.771900869</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Orysp. 1.000 0.925 0.001    3 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elesp. 1.000 0.102 0.030    3 0.087327000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Psespi 1.000 0.905 0.003    3 0.008973027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ludads 1.000 1.000 0.001    3 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polatt 1.000 1.000 0.068    3 0.190442432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Poa1   1.000 0.344 1.000    2 0.717699584</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Helcri 1.000 0.344 1.000    2 0.717699584</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Physp. 1.000 1.000 0.417    3 0.801844713</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goopur 1.000 1.000 0.417    3 0.801844713</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Look for species whose abundance is significantly higher in sites belonging </span></span>
<span class="r-in"><span class="co">## to one group as opposed to sites not belonging to it.</span></span>
<span class="r-in"><span class="fu">signassoc</span><span class="op">(</span><span class="va">wetland</span>, cluster<span class="op">=</span><span class="va">wetkm</span><span class="op">$</span><span class="va">cluster</span>, mode<span class="op">=</span><span class="fl">0</span>, control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span>nperm<span class="op">=</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            1     2     3 best      psidak</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Abefic 0.252 1.000 1.000    1 0.581491008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merhed 0.010 1.000 1.000    1 0.029701000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alyvag 1.000 0.041 1.000    2 0.118025921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pancam 0.001 0.810 1.000    1 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Abemos 0.386 0.607 1.000    1 0.768524456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Melcor 0.001 0.408 1.000    1 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ludoct 0.226 1.000 1.000    1 0.536315176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eupvac 0.001 0.906 0.998    1 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Echpas 0.377 0.487 0.912    1 0.758195633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Passcr 0.239 1.000 1.000    1 0.559288919</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Poa2   1.000 0.329 1.000    2 0.697888289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Carhal 1.000 0.138 0.726    2 0.359496072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dendio 1.000 1.000 0.407    3 0.791472143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Casobt 1.000 1.000 0.409    3 0.793574929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aesind 0.854 0.009 1.000    2 0.026757729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cyprot 0.049 0.420 1.000    1 0.139914649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ipocop 0.131 0.747 1.000    1 0.343765091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cynarc 0.001 0.974 1.000    1 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Walind 0.458 0.551 0.564    1 0.840779912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sessp. 0.342 0.861 0.440    1 0.715109688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Phynod 0.989 0.001 1.000    2 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Echell 0.332 0.201 0.970    2 0.489917601</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Helind 1.000 0.015 0.573    2 0.044328375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ipoaqu 0.826 0.534 0.499    3 0.874248499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Orysp. 1.000 0.973 0.001    3 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elesp. 1.000 0.308 0.083    3 0.228904787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Psespi 1.000 0.949 0.006    3 0.017892216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ludads 1.000 1.000 0.001    3 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polatt 1.000 1.000 0.086    3 0.236448056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Poa1   1.000 0.352 1.000    2 0.727902208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Helcri 1.000 0.352 1.000    2 0.727902208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Physp. 1.000 1.000 0.442    3 0.826258888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goopur 1.000 1.000 0.442    3 0.826258888</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Miquel De Cáceres, Florian Jansen, Noah Dell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

