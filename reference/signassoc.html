<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Statistical significance of species site-group associations — signassoc • indicspecies</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Statistical significance of species site-group associations — signassoc"><meta name="description" content="This function computes the permutation p-value of the association between a species vector and a vector of memberships to a site-group. Four different tests of hypotheses arise from considering either presence/absence or quantitative species data, and from using a non-equalized or group-equalized approach."><meta property="og:description" content="This function computes the permutation p-value of the association between a species vector and a vector of memberships to a site-group. Four different tests of hypotheses arise from considering either presence/absence or quantitative species data, and from using a non-equalized or group-equalized approach."><meta property="og:image" content="https://emf-creaf.github.io/indicspecies/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">indicspecies</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.15</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/IndicatorSpeciesAnalysis.html">Indicator species analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PigeonExample.html">Usage of the niche metric functions (former 'resniche' package)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/indicspecies/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Statistical significance of species site-group associations</h1>
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/indicspecies/blob/HEAD/R/signassoc.R" class="external-link"><code>R/signassoc.R</code></a></small>
      <div class="d-none name"><code>signassoc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes the permutation p-value of the association between a species vector and a vector of memberships to a site-group. Four different tests of hypotheses arise from considering either presence/absence or quantitative species data, and from using a non-equalized or group-equalized approach.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">signassoc</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  U <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mode <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"greater"</span>,</span>
<span>  control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  permutations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  print.perm <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Community data table (rows are sites, columns are species).</p></dd>


<dt id="arg-u">U<a class="anchor" aria-label="anchor" href="#arg-u"></a></dt>
<dd><p>A matrix of group memberships. Each column corresponds to one site-group. Membership values can be crisp or fuzzy. If this matrix is not provided, vector gmv will be used.</p></dd>


<dt id="arg-cluster">cluster<a class="anchor" aria-label="anchor" href="#arg-cluster"></a></dt>
<dd><p>A vector of numeric group labels for sites.</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>Association mode, 0 (site-based) or 1 (group-based).</p></dd>


<dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>Alternative statistical hypothesis: "greater" (positive association), "less" (negative association), "two.sided" (either positive or negative).</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list of control values describing properties of the permutation design, as returned by a call to <code>how</code>.</p></dd>


<dt id="arg-permutations">permutations<a class="anchor" aria-label="anchor" href="#arg-permutations"></a></dt>
<dd><p>A custom matrix of permutations, to be used if <code>control = NULL</code>, with permutations in rows and site indices in columns.</p></dd>


<dt id="arg-print-perm">print.perm<a class="anchor" aria-label="anchor" href="#arg-print-perm"></a></dt>
<dd><p>If TRUE, prints permutation numbers after each set of 100 permutations.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a matrix of p-values, where species are in rows and groups are in columns. Two additional columns indicate the group with lowest p-value and the p-value for this group after Sidak's correction for multiple testing.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Input data for this function is the species matrix X and either a matrix of group memberships (U) or a vector of numeric group labels (cluster). This R function works for both presence/absence and quantitative species data, depending on the values of the input matrix X.
If <code>mode = 0</code>, the null ecological hypothesis is that the frequency (or abundance) of the species of interest in sites belonging to the site group is not higher than the frequency (or abundance) in sites not belonging to it. If <code>mode = 1</code>, the null ecological hypothesis is that the relative frequency (average abundance) of the species of interest is not higher in the target site group than in other groups. See De Cáceres and Legendre for more details.</p>
<p>Complex permutation designs are allowed through the function <code>how</code> from package "permute". If those are not enough, the user can set <code>control = NULL</code> and specify a custom matrix of permutations to test with parameter <code>permutations</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Users should be aware that the significance test in <code>signassoc</code> is not exactly the same as the one in <code>indval</code> from <code>labdsv</code> package. The <code>signassoc</code> function is using the preference for the target group (either non-equalized or group-equalized) as test statistic. After every permutation the preference for the target group is recalculated. The function is therefore testing the null hypothesis stating that the preference of the species for a given site group is due to chance only (as in Bakker 2008). The test is repeated for every group, and this is the reason why there are as many p-values as groups. In contrast, the <code>indval</code> function from <code>labdsv</code> package uses the maximum preference value as test statistic, and the maximum preference value is recalculated after each permutation. The maximum preference may correspond to other groups than the one chosen for the unpermuted data. <code>indval</code> function from <code>labdsv</code> package is therefore testing the null hypothesis saying that the group with observed maximum preference is not such, because the maximum preference was in that group due to chance only. In order to get the consistent results compared to the <code>indval</code> function, users should use the function <code><a href="multipatt.html">multipatt</a></code>, along with the option <code>duleg=TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bakker, J. 2008. Increasing the utility of Indicator Species Analysis. Journal of Applied Ecology 45: 1829-1835.</p>
<p>De Cáceres, M. and Legendre, P. 2009. Associations between species and groups of sites: indices and statistical inference. Ecology 90(12): 3566-3574.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="strassoc.html">strassoc</a></code>, <code><a href="multipatt.html">multipatt</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Miquel De Cáceres Ainsa,  EMF-CREAF</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wetland</span><span class="op">)</span> <span class="co">## Load species data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">wetkm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">wetland</span>, centers<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="co">## Create three clusters using</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Look for species whose abundance is significantly higher in one of the three groups</span></span></span>
<span class="r-in"><span><span class="fu">signassoc</span><span class="op">(</span><span class="va">wetland</span>, cluster<span class="op">=</span><span class="va">wetkm</span><span class="op">$</span><span class="va">cluster</span>, mode<span class="op">=</span><span class="fl">1</span>, control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span>nperm<span class="op">=</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            1     2     3 best      psidak</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Abefic 1.000 0.226 1.000    2 0.536315176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merhed 1.000 0.021 1.000    2 0.061686261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alyvag 0.027 1.000 1.000    1 0.078832683</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pancam 0.821 0.002 0.999    2 0.005988008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Abemos 0.564 0.447 1.000    2 0.830887623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Melcor 0.551 0.001 1.000    2 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ludoct 1.000 0.233 1.000    2 0.548782337</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eupvac 0.880 0.002 0.995    2 0.005988008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Echpas 0.460 0.342 0.864    2 0.715109688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Passcr 1.000 0.252 1.000    2 0.581491008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Poa2   0.354 1.000 1.000    1 0.730413864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Carhal 0.085 1.000 0.553    1 0.233939125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dendio 1.000 1.000 0.443    3 0.827191307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Casobt 1.000 1.000 0.405    3 0.789355125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aesind 0.008 0.849 1.000    1 0.023808512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cyprot 0.507 0.052 1.000    2 0.148028608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ipocop 0.729 0.158 1.000    2 0.403052312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cynarc 0.965 0.001 1.000    2 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Walind 0.530 0.431 0.497    2 0.815779991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sessp. 0.829 0.235 0.421    2 0.552302875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Phynod 0.001 0.992 1.000    1 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Echell 0.211 0.329 0.955    1 0.508830931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Helind 0.001 1.000 0.406    1 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ipoaqu 0.426 0.694 0.395    3 0.778554875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Orysp. 0.933 1.000 0.001    3 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elesp. 0.132 1.000 0.035    3 0.101367875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Psespi 0.902 1.000 0.006    3 0.017892216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ludads 1.000 1.000 0.001    3 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polatt 1.000 1.000 0.054    3 0.153409464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Poa1   0.338 1.000 1.000    1 0.709882472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Helcri 0.338 1.000 1.000    1 0.709882472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Physp. 1.000 1.000 0.414    3 0.798769944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goopur 1.000 1.000 0.414    3 0.798769944</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Look for species whose abundance is significantly higher in sites belonging </span></span></span>
<span class="r-in"><span><span class="co">## to one group as opposed to sites not belonging to it.</span></span></span>
<span class="r-in"><span><span class="fu">signassoc</span><span class="op">(</span><span class="va">wetland</span>, cluster<span class="op">=</span><span class="va">wetkm</span><span class="op">$</span><span class="va">cluster</span>, mode<span class="op">=</span><span class="fl">0</span>, control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span>nperm<span class="op">=</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            1     2     3 best      psidak</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Abefic 1.000 0.243 1.000    2 0.566201907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merhed 1.000 0.016 1.000    2 0.047236096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alyvag 0.040 1.000 1.000    1 0.115264000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pancam 0.792 0.002 1.000    2 0.005988008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Abemos 0.584 0.428 1.000    2 0.812850752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Melcor 0.371 0.001 1.000    2 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ludoct 1.000 0.225 1.000    2 0.534515625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eupvac 0.873 0.002 0.991    2 0.005988008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Echpas 0.495 0.381 0.894    2 0.762823341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Passcr 1.000 0.268 1.000    2 0.607776832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Poa2   0.353 1.000 1.000    1 0.729159977</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Carhal 0.130 1.000 0.702    1 0.341497000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dendio 1.000 1.000 0.417    3 0.801844713</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Casobt 1.000 1.000 0.404    3 0.788291264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aesind 0.009 0.824 1.000    1 0.026757729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cyprot 0.415 0.054 1.000    2 0.153409464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ipocop 0.709 0.156 1.000    2 0.398788416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cynarc 0.963 0.001 1.000    2 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Walind 0.571 0.486 0.566    2 0.864203256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sessp. 0.878 0.330 0.438    2 0.699237000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Phynod 0.001 0.988 1.000    1 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Echell 0.211 0.312 0.974    1 0.508830931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Helind 0.018 1.000 0.578    1 0.053033832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ipoaqu 0.549 0.808 0.523    3 0.891468667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Orysp. 0.975 1.000 0.001    3 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elesp. 0.297 1.000 0.091    3 0.248910571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Psespi 0.947 1.000 0.004    3 0.011952064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ludads 1.000 1.000 0.001    3 0.002997001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polatt 1.000 1.000 0.061    3 0.172063981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Poa1   0.349 1.000 1.000    1 0.724105549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Helcri 0.349 1.000 1.000    1 0.724105549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Physp. 1.000 1.000 0.438    3 0.822495672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goopur 1.000 1.000 0.438    3 0.822495672</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Florian Jansen, Noah Dell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

