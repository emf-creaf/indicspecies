<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Resource niche metrics for a single niche — nichevar • indicspecies</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Resource niche metrics for a single niche — nichevar"><meta property="og:description" content="Function nichepref computes the species resource preference from a the species resource use (and resource availability when given). Function nichecentroid computes the centroid on the resource space for a set of species. Function nichevar computes the multivariate resource variance for a set of species (i.e. niche breadth). In all functions resources are given in distance matrix D, the species resource use is given in P and the availability of resources, if present, are given by vector q."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">indicspecies</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/IndicatorSpeciesAnalysis.html">Indicator Species Analysis using 'indicspecies'</a>
    </li>
    <li>
      <a href="../articles/PigeonExample.html">Usage of the niche metric functions (former 'resniche' package)</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Resource niche metrics for a single niche</h1>
    
    <div class="hidden name"><code>nichevar.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function <code>nichepref</code> computes the species resource preference from a the species resource use (and resource availability when given). Function <code>nichecentroid</code> computes the centroid on the resource space for a set of species. Function <code>nichevar</code> computes the multivariate resource variance for a set of species (i.e. niche breadth). In all functions resources are given in distance matrix <code>D</code>, the species resource use is given in <code>P</code> and the availability of resources, if present, are given by vector <code>q</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">nichevar</span><span class="op">(</span><span class="va">P</span>, D <span class="op">=</span> <span class="cn">NULL</span>, q <span class="op">=</span> <span class="cn">NULL</span>, mode<span class="op">=</span><span class="st">"multiple"</span>, Np <span class="op">=</span> <span class="cn">NULL</span>, 
Nq <span class="op">=</span> <span class="cn">NULL</span>, nboot <span class="op">=</span> <span class="fl">1000</span>, alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>
<span class="fu">nichecentroid</span><span class="op">(</span><span class="va">P</span>, D <span class="op">=</span> <span class="cn">NULL</span>, q <span class="op">=</span> <span class="cn">NULL</span>, mode<span class="op">=</span><span class="st">"multiple"</span>, Np <span class="op">=</span> <span class="cn">NULL</span>, 
Nq <span class="op">=</span> <span class="cn">NULL</span>, nboot <span class="op">=</span> <span class="fl">1000</span>, alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>
<span class="fu">nichepref</span><span class="op">(</span><span class="va">P</span>, D <span class="op">=</span> <span class="cn">NULL</span>, q <span class="op">=</span> <span class="cn">NULL</span>, mode<span class="op">=</span><span class="st">"multiple"</span>, Np <span class="op">=</span> <span class="cn">NULL</span>, 
Nq <span class="op">=</span> <span class="cn">NULL</span>, nboot <span class="op">=</span> <span class="fl">1000</span>, alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>P</dt>
<dd><p>Data frame containing the relative or absolute usage that a set of species (in rows) make of a set of resources (in columns).</p></dd>
<dt>D</dt>
<dd><p>Object of type <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> containing distance values between resources. If no distance matrix is provided (i.e. if <code>D==NULL</code>), the distances between resources is assumed to be maximum.</p></dd>
<dt>q</dt>
<dd><p>Vector with the availability of each resource.</p></dd>
<dt>mode</dt>
<dd><p>Either <code>mode = "single"</code> (rows of matrix P are individual observations to be pooled for a single niche) or <code>mode = "multiple"</code> (rows in P represent different niches).</p></dd>
<dt>Np</dt>
<dd><p>Vector with the number of observations per species from which the values in <code>P</code> come (in <code>mode = "multiple"</code>).</p></dd>
<dt>Nq</dt>
<dd><p>The number of observations per species from which the values in <code>q</code> come (in <code>mode = "multiple"</code>).</p></dd>
<dt>nboot</dt>
<dd><p>Number of boostrap samples used to compute bias-corrected percentile confidence intervals.</p></dd>
<dt>alpha</dt>
<dd><p>Used to set the confidence level (i.e. <code>alpha = 0.05</code> means 95 percent confidence interval).</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The method is described in De Caceres et al. (2010). If the distance matrix is not specified (i.e. if <code>D=NULL</code>) the function assumes that all resources are at a maximum distance (<code>d=1</code>). If the resource availability vector <code>q</code> is given then the values in <code>P</code> are taken as assessments of resource use and the species preference is calculated taking into account resource availability. Otherwise resource use is equated to resource preference. Moreover, most functions can compute bootstrap confidence intervals following the bias-corrected percentile method (Manly 2007). If <code>mode = "multiple"</code> and <code>Np != NULL</code>, bootstrap samples for a given species are generated assuming a multinomial distribution with the proportions calculated from the corresponding row values in <code>P</code>, and the number of observations comes from the corresponding element in <code>Np</code>. If <code>mode = "single"</code> then the bootstrapped units are the rows of matrix <code>P</code>. In both cases, if <code>Nq</code> is indicated the availability of resources is also bootstrapped. The bias-corrected percentile method was described for overlap niche measures in Mueller and Altenberg (1985) and is extended here for all niche metrics.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>Function <code>nichepref</code> returns a matrix of species relative preference. Function <code>nichevar</code> returns a vector with the variance of the resources used for each species in <code>P</code>. Function <code>nichecentroid</code> returns a matrix niche centroid in the resource space for each species in <code>df</code>. If bootstrap confidence intervals are asked then the three functions also compute two extra data containing respectively the lower and upper bounds of the confidence intervals obtained following the bias-corrected percentile method. Function <code>nichearea</code> returns the area of the convex hull occupied by the resources used for each species in <code>P</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Mueller, L.D. and L. Altenberg. 1985. Statistical Inference on Measures of Niche Overlap. Ecology 66:1204-1210.</p>
<p>Manly, B.F.J. 2007. Randomization, bootstrap and Monte Carlo methods in biology. Chapman and Hall texts in statistical science series. 2nd edition.</p>
<p>De Caceres, M., Sol, D., Lapiedra, O. and P. Legendre. (2011) A framework for estimating niche metrics using the resemblance between qualitative resources. Oikos 120: 1341-1350.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Miquel De Caceres Ainsa, CTFC</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See <code><a href="nicheoverlap.html">nicheoverlap</a></code> for descriptors comparing two niches.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Loads example data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">birds</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># The niche metrics using distances among resources and assuming equal availability of resources</span></span>
<span class="r-in"><span class="fu">nichepref</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         R1   R2   R3  R4   R5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.50 0.50 0.00 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B  0.00 0.25 0.50 0.0 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B  1.00 0.00 0.00 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.65 0.35 0.00 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.40 0.20 0.40 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B  0.00 0.00 0.35 0.0 0.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.50 0.35 0.15 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  0.95 0.00 0.05 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.25 0.40 0.35 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B 0.00 0.08 0.40 0.2 0.32</span>
<span class="r-in"><span class="fu">nichevar</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.13225261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B  0.12781527</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.12034987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.18250903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B  0.08535149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.16362581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  0.03317008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.16380429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B 0.20396760</span>
<span class="r-in"><span class="fu">nichecentroid</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                V1          V2           V3           V4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B   0.24597349  0.25041608  0.045122608  0.075213112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B   0.13250560 -0.21553586  0.061091362 -0.058985020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B   0.22651901  0.48162424 -0.203930962 -0.052807341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B   0.24013715  0.31977853 -0.029593463  0.036806976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B   0.19752919  0.09742813  0.025164313 -0.093896341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B   0.04412588 -0.33760340 -0.146142948 -0.016090090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B   0.22634779  0.21038621  0.018959229  0.002195533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B   0.22192256  0.44516013 -0.187746731 -0.064344489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B   0.20990744  0.04140897  0.108601510 -0.031151012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B -0.05078743 -0.19448564 -0.005282383 -0.055185385</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># The niche metrics using distances among resources and computes </span></span>
<span class="r-in"><span class="co"># 95 percent confidence intervals</span></span>
<span class="r-in"><span class="fu">nichepref</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, mode<span class="op">=</span><span class="st">"multiple"</span>, </span>
<span class="r-in">Np <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">birdsbreed</span><span class="op">)</span>, Nq <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         R1   R2   R3  R4   R5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.50 0.50 0.00 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B  0.00 0.25 0.50 0.0 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B  1.00 0.00 0.00 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.65 0.35 0.00 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.40 0.20 0.40 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B  0.00 0.00 0.35 0.0 0.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.50 0.35 0.15 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  0.95 0.00 0.05 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.25 0.40 0.35 0.0 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B 0.00 0.08 0.40 0.2 0.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $LF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              R1         R2         R3         R4        R5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.2500000 0.23076923         NA         NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B         NA 0.07483630 0.26438117         NA 0.0663130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B         NA         NA         NA         NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.3848684 0.11952191         NA         NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.1822323 0.04446241 0.18513324         NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B         NA         NA 0.13473054         NA 0.3913043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.2408759 0.14326648 0.02555366         NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  0.7570093         NA 0.00000000         NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.0866426 0.16608392 0.13413586         NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B        NA 0.00000000 0.20252865 0.05329502 0.1330377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $UF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              R1        R2        R3        R4        R5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.7500000 0.7397260        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B         NA 0.4833837 0.7512195        NA 0.5105438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B         NA        NA        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.8695652 0.5990099        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.6730445 0.4425454 0.6631412        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B         NA        NA 0.5876289        NA 0.8571429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.7400990 0.6250000 0.4037715        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  1.0000000        NA 0.2173913        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.4947669 0.6509938 0.6129846        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B        NA 0.2568324 0.6623172 0.4227761 0.5427227</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">nichevar</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, mode<span class="op">=</span><span class="st">"multiple"</span>, </span>
<span class="r-in">Np <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">birdsbreed</span><span class="op">)</span>, Nq <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                B         LC         UC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.13225261 0.13225261 0.13225261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B  0.12781527 0.09271778 0.15014267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B  0.00000000 0.00000000 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.12034987 0.05698789 0.13218730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.18250903 0.18226959 0.18298264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B  0.08535149 0.04207392 0.09376636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.16362581 0.13202571 0.18214229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  0.03317008 0.00000000 0.11687272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.16380429 0.12154116 0.18266440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B 0.20396760 0.14963733 0.24569923</span>
<span class="r-in"><span class="fu">nichecentroid</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, mode<span class="op">=</span><span class="st">"multiple"</span>, </span>
<span class="r-in">Np <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">birdsbreed</span><span class="op">)</span>, Nq <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                V1          V2           V3           V4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B   0.24597349  0.25041608  0.045122608  0.075213112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B   0.13250560 -0.21553586  0.061091362 -0.058985020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B   0.22651901  0.48162424 -0.203930962 -0.052807341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B   0.24013715  0.31977853 -0.029593463  0.036806976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B   0.19752919  0.09742813  0.025164313 -0.093896341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B   0.04412588 -0.33760340 -0.146142948 -0.016090090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B   0.22634779  0.21038621  0.018959229  0.002195533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B   0.22192256  0.44516013 -0.187746731 -0.064344489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B   0.20990744  0.04140897  0.108601510 -0.031151012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B -0.05078743 -0.19448564 -0.005282383 -0.055185385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $LC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                V1          V2          V3           V4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B   0.23585716  0.12560459 -0.08438525  0.008642476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B   0.08460306 -0.27883940 -0.06341647 -0.183800040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B           NA          NA          NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B   0.23100851  0.18649031 -0.14645706 -0.023264160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B   0.16840312 -0.06682536 -0.06494300 -0.178063636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B   0.01281139 -0.36873839 -0.23818408 -0.130636456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B   0.20155897  0.07772159 -0.09800741 -0.082841863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B   0.20300229  0.29506370 -0.20393096 -0.109814424</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B   0.17865188 -0.08591996 -0.01000829 -0.139991271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B -0.21849105 -0.26793820 -0.11331541 -0.143331897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $UC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               V1          V2          V3            V4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.25596363  0.36548247  0.17301498  0.1409533449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B  0.18086428 -0.13090158  0.15357567  0.0516441133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B          NA          NA          NA            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.25055102  0.42523200  0.10475515  0.1053355717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.22121030  0.25012865  0.12392163 -0.0005456621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B  0.08012999 -0.30180568 -0.04031788  0.0731849604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.24393161  0.35197480  0.13019485  0.0836239717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  0.22651901  0.48162424 -0.12439071 -0.0528073410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.23692043  0.19855218  0.19616509  0.0754682908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B 0.05873460 -0.09484733  0.06711582  0.0344737125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Same computations with different resource availability</span></span>
<span class="r-in"><span class="fu">nichepref</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, </span>
<span class="r-in">q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.18</span>, <span class="fl">0.24</span>, <span class="fl">0.22</span>, <span class="fl">0.21</span>, <span class="fl">0.15</span><span class="op">)</span>, mode<span class="op">=</span><span class="st">"multiple"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              R1         R2        R3        R4        R5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.5714286 0.42857143 0.0000000 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B  0.0000000 0.20912548 0.4562738 0.0000000 0.3346008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B  1.0000000 0.00000000 0.0000000 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.7123288 0.28767123 0.0000000 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.4559585 0.17098446 0.3730570 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B  0.0000000 0.00000000 0.2685422 0.0000000 0.7314578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.5648267 0.29653402 0.1386393 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  0.9587156 0.00000000 0.0412844 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.2989130 0.35869565 0.3423913 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B 0.0000000 0.06364688 0.3471648 0.1818482 0.4073401</span>
<span class="r-in"><span class="fu">nichevar</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, </span>
<span class="r-in">q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.18</span>, <span class="fl">0.24</span>, <span class="fl">0.22</span>, <span class="fl">0.21</span>, <span class="fl">0.15</span><span class="op">)</span>, mode<span class="op">=</span><span class="st">"multiple"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.1295536</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B  0.1320325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.1084030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.1827155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B  0.0736939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.1579114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  0.0276394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.1718765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B 0.1962885</span>
<span class="r-in"><span class="fu">nichecentroid</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, </span>
<span class="r-in">q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.18</span>, <span class="fl">0.24</span>, <span class="fl">0.22</span>, <span class="fl">0.21</span>, <span class="fl">0.15</span><span class="op">)</span>, mode<span class="op">=</span><span class="st">"multiple"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                V1          V2           V3           V4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B   0.24319428  0.28344582  0.009543526  0.056924476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B   0.11538330 -0.23815073  0.019354147 -0.044070792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B   0.22651901  0.48162424 -0.203930962 -0.052807341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B   0.23771200  0.34860037 -0.060639867  0.020848262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B   0.19887707  0.13049445  0.001990427 -0.095108599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B   0.03278895 -0.34887535 -0.179465029  0.017427941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B   0.22531187  0.24339492 -0.011349848 -0.008872539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B   0.22272378  0.45151626 -0.190567836 -0.062333426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B   0.20899979  0.06605766  0.085564702 -0.039970962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B -0.05135008 -0.21784274 -0.043129123 -0.032448647</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># The niche metrics using distances among resources and </span></span>
<span class="r-in"><span class="co"># computes 95 percent confidence intervals</span></span>
<span class="r-in"><span class="fu">nichepref</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, </span>
<span class="r-in">q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.18</span>, <span class="fl">0.24</span>, <span class="fl">0.22</span>, <span class="fl">0.21</span>, <span class="fl">0.15</span><span class="op">)</span>, mode<span class="op">=</span><span class="st">"multiple"</span>, Np <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">birdsbreed</span><span class="op">)</span>, Nq <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              R1         R2        R3        R4        R5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.5714286 0.42857143 0.0000000 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B  0.0000000 0.20912548 0.4562738 0.0000000 0.3346008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B  1.0000000 0.00000000 0.0000000 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.7123288 0.28767123 0.0000000 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.4559585 0.17098446 0.3730570 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B  0.0000000 0.00000000 0.2685422 0.0000000 0.7314578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.5648267 0.29653402 0.1386393 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  0.9587156 0.00000000 0.0412844 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.2989130 0.35869565 0.3423913 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B 0.0000000 0.06364688 0.3471648 0.1818482 0.4073401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $LF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              R1         R2         R3        R4        R5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.3090129 0.19642857         NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B         NA 0.05223464 0.21192361        NA 0.1215122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B         NA         NA         NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.4600000 0.09484193         NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.2092050 0.04255319 0.16356877        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B         NA         NA 0.09278351        NA 0.4657534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.3141542 0.10714286 0.01785714        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  0.8288288         NA 0.00000000        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.1002765 0.15574587 0.14376997        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B        NA 0.00000000 0.16935484 0.0497277 0.1866901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $UF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              R1        R2        R3        R4        R5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.7954545 0.6880734        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B         NA 0.4560000 0.7244433        NA 0.6480447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B         NA        NA        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.8981132 0.5319149        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.7141478 0.4023529 0.6345886        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B         NA        NA 0.5172414        NA 0.9056604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.8076923 0.5500000 0.3245564        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  1.0000000        NA 0.1680672        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.5733491 0.6285033 0.6201288        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B        NA 0.2312144 0.5937440 0.4018519 0.6605505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">nichevar</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, </span>
<span class="r-in">q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.18</span>, <span class="fl">0.24</span>, <span class="fl">0.22</span>, <span class="fl">0.21</span>, <span class="fl">0.15</span><span class="op">)</span>, mode<span class="op">=</span><span class="st">"multiple"</span>, Np <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">birdsbreed</span><span class="op">)</span>, Nq <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               B         LC         UC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.1295536 0.10687882 0.13225261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B  0.1320325 0.10576135 0.15068746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B  0.0000000 0.00000000 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.1084030 0.05153202 0.13217393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.1827155 0.18269667 0.18300656</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B  0.0736939 0.03356650 0.09333631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.1579114 0.11345324 0.18143636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  0.0276394 0.00000000 0.10850571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.1718765 0.14019158 0.18297778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B 0.1962885 0.13956649 0.24306563</span>
<span class="r-in"><span class="fu">nichecentroid</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, </span>
<span class="r-in">q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.18</span>, <span class="fl">0.24</span>, <span class="fl">0.22</span>, <span class="fl">0.21</span>, <span class="fl">0.15</span><span class="op">)</span>, mode<span class="op">=</span><span class="st">"multiple"</span>,  Np <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">birdsbreed</span><span class="op">)</span>, Nq <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                V1          V2           V3           V4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B   0.24319428  0.28344582  0.009543526  0.056924476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B   0.11538330 -0.23815073  0.019354147 -0.044070792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B   0.22651901  0.48162424 -0.203930962 -0.052807341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B   0.23771200  0.34860037 -0.060639867  0.020848262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B   0.19887707  0.13049445  0.001990427 -0.095108599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B   0.03278895 -0.34887535 -0.179465029  0.017427941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B   0.22531187  0.24339492 -0.011349848 -0.008872539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B   0.22272378  0.45151626 -0.190567836 -0.062333426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B   0.20899979  0.06605766  0.085564702 -0.039970962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B -0.05135008 -0.21784274 -0.043129123 -0.032448647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $LC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 V1          V2          V3           V4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B   0.234129948  0.14926251 -0.10649683 -0.002723491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B   0.068525261 -0.29878651 -0.09911788 -0.158157449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B            NA          NA          NA           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B   0.230114298  0.23166947 -0.15790464 -0.029148530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B   0.171695587 -0.04101079 -0.10822244 -0.174846915</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B   0.008066768 -0.37345582 -0.25212971 -0.092165533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B   0.202254441  0.10966873 -0.12293909 -0.085627970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B   0.207278055  0.32898380 -0.20393096 -0.101102378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B   0.180230362 -0.07528150 -0.02779511 -0.135401194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B -0.200200089 -0.28983198 -0.15069598 -0.135085427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $UC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               V1         V2          V3          V4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp1B  0.25416485  0.3904911  0.14998727  0.12911646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp2B  0.17122462 -0.1489557  0.13950035  0.05465681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp3B          NA         NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp4B  0.24739699  0.4357992  0.06334604  0.08458046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp5B  0.22121506  0.3170575  0.09896830 -0.01526876</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp6B  0.06913987 -0.3127328 -0.07262060  0.08910834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp7B  0.24168730  0.3897272  0.09990538  0.06881209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp8B  0.22651901  0.4816242 -0.14021352 -0.05280734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp9B  0.23464262  0.2160997  0.17403179  0.06190628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sp10B 0.03996770 -0.1061133  0.05287098  0.04735942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># The following example defines a function to calculate the area of the niche</span></span>
<span class="r-in"><span class="co"># It requires package 'rgeos'</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/rgeos/" class="external-link">rgeos</a></span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: sp</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> rgeos version: 0.5-9, (SVN revision 684)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  GEOS runtime version: 3.10.2-CAPI-1.16.0 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Please note that rgeos will be retired by the end of 2023,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> plan transition to sf functions using GEOS at your earliest convenience.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  GEOS using OverlayNG</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Linking to sp version: 1.4-7 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Polygon checking: TRUE </span>
<span class="r-in"><span class="va">nichearea</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">P</span>, <span class="va">D</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">axes</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span><span class="op">)</span> </span>
<span class="r-in">       <span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">cmd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">D</span>,eig<span class="op">=</span><span class="cn">TRUE</span>,k<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">X</span> <span class="op">=</span> <span class="va">cmd</span><span class="op">$</span><span class="va">points</span></span>
<span class="r-in">    <span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Area<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">        <span class="va">pi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">P</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">)</span></span>
<span class="r-in">        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pi</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="va">V</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span class="r-in">        <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pi</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-16</span><span class="op">)</span> <span class="va">V</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span class="r-in">        <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pi</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="va">V</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span class="r-in">          <span class="kw">else</span> <span class="op">{</span></span>
<span class="r-in">            <span class="va">a</span> <span class="op">=</span><span class="va">X</span><span class="op">[</span><span class="va">pi</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="va">axes</span><span class="op">]</span></span>
<span class="r-in">            <span class="va">V</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/gpc-new-generics.html" class="external-link">area.poly</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/grDevices/chull.html" class="external-link">chull</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>,<span class="op">]</span>,<span class="st">"gpc.poly"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">          <span class="op">}</span>          </span>
<span class="r-in">    <span class="op">}</span></span>
<span class="r-in">    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="fu">nichearea</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Area</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.009518062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.035442544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  0.035442544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.035442544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.204664416</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Miquel De Cáceres, Florian Jansen, Noah Dell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

