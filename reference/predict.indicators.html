<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Predicts site group from indicators — predict.indicators • indicspecies</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predicts site group from indicators — predict.indicators"><meta name="description" content="Function predict.indicators takes an object of class indicators and determines the probability of the indicated site group given a community data set. If no new data set is provided, the function can calculate the probabilities corresponding to the original sites used to build the indicators object."><meta property="og:description" content="Function predict.indicators takes an object of class indicators and determines the probability of the indicated site group given a community data set. If no new data set is provided, the function can calculate the probabilities corresponding to the original sites used to build the indicators object."><meta property="og:image" content="https://emf-creaf.github.io/indicspecies/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">indicspecies</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/IndicatorSpeciesAnalysis.html">Indicator species analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PigeonExample.html">Usage of the niche metric functions (former 'resniche' package)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Predicts site group from indicators</h1>

      <div class="d-none name"><code>predict.indicators.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function <code>predict.indicators</code> takes an object of class <code><a href="indicators.html">indicators</a></code> and determines the probability of the indicated site group given a community data set. If no new data set is provided, the function can calculate the probabilities corresponding to the original sites used to build the <code><a href="indicators.html">indicators</a></code> object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'indicators'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, newdata <span class="op">=</span> <span class="cn">NULL</span>, cv <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class 'indicators'.</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>A community data table (with sites in rows and species in columns) for which predictions are needed. This table can contain either presence-absence or abundance data, but only presence-absence information is used for the prediction. If <code>NULL</code>, then the original data set used to derive the <code><a href="indicators.html">indicators</a></code> object is used as data.</p></dd>


<dt id="arg-cv">cv<a class="anchor" aria-label="anchor" href="#arg-cv"></a></dt>
<dd><p>A boolean flag to indicate that probabilities should be calculated using leave-one-out cross validation (i.e recalculating positive predictive value of indicators after excluding the target site).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>In function <code>predict</code>, additional arguments not used (included for compatibility with <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If confidence intervals are available in <code>x</code>, function <code>predict.indicators</code> returns a matrix where communities are in rows and there are three columns, correspoinding to the probability of the indicated site group along with the confidence interval. If confidence intervals are not available in <code>x</code>, or if <code>cv = TRUE</code>, then <code>predict.indicators</code> returns a single vector with the probability of the indicated site group for each community.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Function <code><a href="indicators.html">indicators</a></code> explores the indicator value of the simultaneous occurrence of sets of species (i.e. species combinations). The method is described in De Cáceres et al. (2012) and is a generalization of the Indicator Value method of Dufrêne &amp; Legendre (1997). The current function <code>predict.indicators</code> is used to predict the indicated site group from the composition of a new set of observations. For communities where one or more of the indicator species combinations are found, the function returns the probability associated to the indicator that has the highest positive predictive value (if confidence intervals are available, the maximum value is calculated across the lower bounds of the confidence interval). For communities where none of the indicator species combinations is found, the function returns zeroes.
If <code>newdata = NULL</code>, the function can be used to evaluate the predictive power of a set of indicators in a cross-validated fashion. For each site in the data set, recalculates the predictive value of indicators after excluding the information of the site, and then evaluates the probability of the site group.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>De Cáceres, M., Legendre, P., Wiser, S.K. and Brotons, L. 2012. Using species combinations in indicator analyses. Methods in Ecology and Evolution 3(6): 973-982.</p>
<p>Dufrêne, M. and P. Legendre. 1997. Species assemblages and indicator species: The need for a flexible asymetrical approach. Ecological Monographs 67:345-366.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="indicators.html">indicators</a></code>, <code><a href="pruneindicators.html">pruneindicators</a></code> <code><a href="coverage.html">coverage</a></code>, <code><a href="multipatt.html">multipatt</a></code>, <code><a href="strassoc.html">strassoc</a></code>, <code><a href="signassoc.html">signassoc</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Miquel De Cáceres Ainsa, EMF-CREAF</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wetland</span><span class="op">)</span> <span class="co">## Loads species data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Creates three clusters using kmeans</span></span></span>
<span class="r-in"><span><span class="va">wetkm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">wetland</span>, centers<span class="op">=</span><span class="fl">3</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Run indicator analysis with species combinations for the first group</span></span></span>
<span class="r-in"><span><span class="va">sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="indicators.html">indicators</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">wetland</span>, cluster<span class="op">=</span><span class="va">wetkm</span><span class="op">$</span><span class="va">cluster</span>, group<span class="op">=</span><span class="fl">1</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>, At<span class="op">=</span><span class="fl">0.5</span>, Bt<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Target site group: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of candidate species: 33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of sites: 41 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size of the site group: 14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  1 ... accepted combinations: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  2 ... accepted combinations: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  3 ... accepted combinations: 16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  4 ... accepted combinations: 32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  5 ... accepted combinations: 32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  6 ... accepted combinations: 79 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  7 ... accepted combinations: 79 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  8 ... accepted combinations: 82 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  9 ... accepted combinations: 88 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  10 ... accepted combinations: 88 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  11 ... accepted combinations: 88 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  12 ... accepted combinations: 92 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  13 ... accepted combinations: 92 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  14 ... accepted combinations: 92 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  15 ... accepted combinations: 112 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  16 ... accepted combinations: 115 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  17 ... accepted combinations: 115 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  18 ... accepted combinations: 115 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  19 ... accepted combinations: 115 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  20 ... accepted combinations: 120 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  21 ... accepted combinations: 136 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  22 ... accepted combinations: 139 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  23 ... accepted combinations: 143 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  24 ... accepted combinations: 144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  25 ... accepted combinations: 144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  26 ... accepted combinations: 144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  27 ... accepted combinations: 144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  28 ... accepted combinations: 144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  29 ... accepted combinations: 144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  30 ... accepted combinations: 144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  31 ... accepted combinations: 144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  32 ... accepted combinations: 144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting species  33 ... accepted combinations: 144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of valid combinations: 144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of remaining species: 15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating statistical significance (permutational test)...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use the indicators to make predictions of the probability of group #1</span></span></span>
<span class="r-in"><span><span class="co">## Normally an independent data set should be used, because 'wetland' was used to derive</span></span></span>
<span class="r-in"><span><span class="co">## indicators. The same would be obtained calling 'predict(sc)' without further arguments.</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">sc</span>, <span class="va">wetland</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate cross-validated probabilities (recalculates 'A' statistics once for each site </span></span></span>
<span class="r-in"><span><span class="co">## after excluding it, and then calls predict.indicators for that site)</span></span></span>
<span class="r-in"><span><span class="va">pcv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">sc</span>, cv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Show original membership to group 1 along with (resubstitution) predicted probabilities  </span></span></span>
<span class="r-in"><span><span class="co">## and cross-validated probabilities. Cross-validated probabilities can be lower for sites</span></span></span>
<span class="r-in"><span><span class="co">## originally belonging to the target site group and higher for other sites.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Group1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">wetkm</span><span class="op">$</span><span class="va">cluster</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>, Prob <span class="op">=</span> <span class="va">p</span>, Prob_CV <span class="op">=</span> <span class="va">pcv</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Group1      Prob   Prob_CV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       0 0.7500000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       0 0.8000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      0 0.6250000 0.7142857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       0 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      0 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       0 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       0 0.5714286 0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      0 0.6428571 0.6923077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      0 0.6666667 0.8571429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      0 0.8571429 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       0 0.7777778 0.8750000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      0 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       0 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       0 0.8333333 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      0 0.6428571 0.6923077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40      1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23      1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25      1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22      1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20      1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39      1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30      0 0.5000000 0.6000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34      0 0.5000000 0.6000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28      0 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31      0 0.5000000 0.6000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26      1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29      1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33      1 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24      0 0.9473684 0.9642857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36      0 0.9473684 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37      0 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41      0 0.5000000 0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27      0 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32      0 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35      0 0.8000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38      0 0.5000000 0.6000000</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Florian Jansen, Noah Dell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

