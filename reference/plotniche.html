<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Draws a single resource niche — plotniche • indicspecies</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Draws a single resource niche — plotniche"><meta name="description" content="Function plotniche draws a resource niche on the resource space computed by means of principal coordinates analysis. Resource relationships are given in distance matrix D, the species resource use is given in P and the availability of resources is given by vector q."><meta property="og:description" content="Function plotniche draws a resource niche on the resource space computed by means of principal coordinates analysis. Resource relationships are given in distance matrix D, the species resource use is given in P and the availability of resources is given by vector q."><meta property="og:image" content="https://emf-creaf.github.io/indicspecies/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">indicspecies</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.15</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/IndicatorSpeciesAnalysis.html">Indicator species analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PigeonExample.html">Usage of the niche metric functions (former 'resniche' package)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/indicspecies/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Draws a single resource niche</h1>
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/indicspecies/blob/HEAD/R/plotniche.R" class="external-link"><code>R/plotniche.R</code></a></small>
      <div class="d-none name"><code>plotniche.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function <code>plotniche</code> draws a resource niche on the resource space computed by means of principal coordinates analysis. Resource relationships are given in distance matrix <code>D</code>, the species resource use is given in <code>P</code> and the availability of resources is given by vector <code>q</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotniche</span><span class="op">(</span></span>
<span>  <span class="va">P</span>,</span>
<span>  D <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  q <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"multiple"</span>,</span>
<span>  Np <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Nq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  chull <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bubbles <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  writeName <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-p">P<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Data frame containing the relative or absolute usage that a set of species (in rows) make of a set of resources (in columns).</p></dd>


<dt id="arg-d">D<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>Object of type <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> containing distance values between resources. If no distance matrix is provided (i.e. if <code>D==NULL</code>), the distances between resources is assumed to be maximum.</p></dd>


<dt id="arg-q">q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>Vector with the availability of each resource.</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>Either <code>mode = "single"</code> (rows of matrix P are individual observations to be pooled for a single niche) or <code>mode = "multiple"</code> (rows in P represent different niches).</p></dd>


<dt id="arg-np">Np<a class="anchor" aria-label="anchor" href="#arg-np"></a></dt>
<dd><p>Vector with the number of observations per species from which the values in <code>P</code> come (in <code>mode = "multiple"</code>).</p></dd>


<dt id="arg-nq">Nq<a class="anchor" aria-label="anchor" href="#arg-nq"></a></dt>
<dd><p>The number of observations per species from which the values in <code>q</code> come.</p></dd>


<dt id="arg-nboot">nboot<a class="anchor" aria-label="anchor" href="#arg-nboot"></a></dt>
<dd><p>Number of boostrap samples used to compute bias-corrected percentile confidence intervals.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Used to set the confidence level (i.e. <code>alpha = 0.05</code> means 95 percent confidence interval).</p></dd>


<dt id="arg-species">species<a class="anchor" aria-label="anchor" href="#arg-species"></a></dt>
<dd><p>Specifies which species niche is to be plot. This parameter is mandatory and can be either an numeric index or a string for a species name.</p></dd>


<dt id="arg-axes">axes<a class="anchor" aria-label="anchor" href="#arg-axes"></a></dt>
<dd><p>PCoA axes used for plotting.</p></dd>


<dt id="arg-chull">chull<a class="anchor" aria-label="anchor" href="#arg-chull"></a></dt>
<dd><p>Logical flag indicating whether or not convex hulls should be drawn (only in <code>type="single"</code>).</p></dd>


<dt id="arg-bubbles">bubbles<a class="anchor" aria-label="anchor" href="#arg-bubbles"></a></dt>
<dd><p>Logical flag to draws bubbles proportional to resource preference data.</p></dd>


<dt id="arg-writename">writeName<a class="anchor" aria-label="anchor" href="#arg-writename"></a></dt>
<dd><p>Logical flag indicating whether or not the name of the species should be drawn beside the centroid.</p></dd>


<dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>If <code>TRUE</code>, the current plot is used. This is helpful to draw more than one species on the same plot (see examples).</p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>Color of the centroid and confidence interval arrows.</p></dd>


<dt id="arg-lty">lty<a class="anchor" aria-label="anchor" href="#arg-lty"></a></dt>
<dd><p>Line type of the confidence interval arrows.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional graphical parameters.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The method is described in De Caceres et al. (in prep). If the distance matrix is not specified (i.e. if <code>D=NULL</code>) the function assumes that all resources are at a maximum distance (<code>d=1</code>). If the resource availability vector <code>q</code> is given then the values in <code>P</code> are taken as assessments of resource use and the species preference is calculated taking into account resource availability. Otherwise resource use is equated to resource preference. The function can also plot bootstrap confidence intervals following the bias-corrected percentile method (Manly 2007). If If <code>mode = "multiple"</code> and <code>Np != NULL</code>, bootstrap samples for a given species are generated assuming a multinomial distribution with the proportions calculated from the corresponding row values in <code>P</code>, and the number of observations comes from the corresponding element in <code>Np</code>. If <code>mode = "single"</code> then the bootstrapped units are the rows of matrix <code>P</code>. In both cases, if <code>Nq</code> is indicated, the availability of resources is also bootstrapped. The bias-corrected percentile method was described for overlap niche measures in Mueller and Altenberg (1985) and is extended here for all niche metrics except <code>nichearea</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Mueller, L.D. and L. Altenberg. 1985. Statistical Inference on Measures of Niche Overlap. Ecology 66:1204-1210.</p>
<p>Manly, B.F.J. 2007. Randomization, bootstrap and Monte Carlo methods in biology. Chapman and Hall texts in statistical science series. 2nd edition.</p>
<p>De Caceres, M., Sol, D., Lapiedra, O. and P. Legendre. (2011) A framework for estimating niche metrics using the resemblance between qualitative resources. Oikos 120: 1341-1350.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="nichevar.html">nichevar</a></code> and <code><a href="nicheoverlap.html">nicheoverlap</a></code> to obtain a resource niche metrics.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Miquel De Caceres Ainsa, EMF-CREAF</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Loads example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">birds</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plotniche</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, mode<span class="op">=</span><span class="st">"multiple"</span>, species<span class="op">=</span><span class="fl">10</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="plotniche-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Plotting species : sp10B  #: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">plotniche</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, mode<span class="op">=</span><span class="st">"multiple"</span>, </span></span>
<span class="r-in"><span>          Np <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">birdsbreed</span><span class="op">)</span>, Nq <span class="op">=</span> <span class="fl">100</span>, species<span class="op">=</span><span class="fl">10</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="plotniche-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Plotting species : sp10B  #: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">plotniche</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, </span></span>
<span class="r-in"><span>          q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.18</span>, <span class="fl">0.24</span>, <span class="fl">0.22</span>, <span class="fl">0.21</span>, <span class="fl">0.15</span><span class="op">)</span>, mode<span class="op">=</span><span class="st">"multiple"</span>, species<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotniche-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Plotting species : sp10B  #: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">plotniche</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, </span></span>
<span class="r-in"><span>          q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.18</span>, <span class="fl">0.24</span>, <span class="fl">0.22</span>, <span class="fl">0.21</span>, <span class="fl">0.15</span><span class="op">)</span>, mode<span class="op">=</span><span class="st">"multiple"</span>, </span></span>
<span class="r-in"><span>          Np <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">birdsbreed</span><span class="op">)</span>, Nq <span class="op">=</span> <span class="fl">100</span>, species<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotniche-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Plotting species : sp10B  #: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#draw two species</span></span></span>
<span class="r-in"><span><span class="fu">plotniche</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>, mode<span class="op">=</span><span class="st">"multiple"</span>, </span></span>
<span class="r-in"><span>          Np <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">birdsbreed</span><span class="op">)</span>, Nq <span class="op">=</span> <span class="fl">100</span>, species<span class="op">=</span><span class="fl">10</span>, writeName<span class="op">=</span><span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>          bubbles<span class="op">=</span><span class="cn">FALSE</span>, chull<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Plotting species : sp10B  #: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">plotniche</span><span class="op">(</span><span class="va">birdsbreed</span>, D <span class="op">=</span> <span class="va">resourceD</span>,  mode<span class="op">=</span><span class="st">"multiple"</span>, </span></span>
<span class="r-in"><span>          Np <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">birdsbreed</span><span class="op">)</span>, Nq <span class="op">=</span> <span class="fl">100</span>, species<span class="op">=</span><span class="fl">1</span>, writeName<span class="op">=</span><span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>          bubbles<span class="op">=</span><span class="cn">FALSE</span>, chull<span class="op">=</span><span class="cn">FALSE</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="plotniche-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Plotting species : sp1B  #: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Florian Jansen, Noah Dell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

