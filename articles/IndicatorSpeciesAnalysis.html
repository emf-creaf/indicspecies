<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Indicator Species Analysis using 'indicspecies' • indicspecies</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Indicator Species Analysis using 'indicspecies'">
<meta property="og:description" content="indicspecies">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">indicspecies</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/IndicatorSpeciesAnalysis.html">Indicator Species Analysis using 'indicspecies'</a>
    </li>
    <li>
      <a href="../articles/PigeonExample.html">Usage of the niche metric functions (former 'resniche' package)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="IndicatorSpeciesAnalysis_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Indicator Species Analysis using ‘indicspecies’</h1>
                        <h4 class="author">Miquel De Cáceres, CREAF</h4>
            
            <h4 class="date">2021-06-07</h4>
      
      
      <div class="hidden name"><code>IndicatorSpeciesAnalysis.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Determining the occurrence or abundance of a small set of indicator species, as an alternative to sampling the entire community, has been particularly useful in longterm environmental monitoring for conservation or ecological management. Species are chosen as indicators if they:</p>
<ol style="list-style-type: lower-roman">
<li>reflect the biotic or abiotic state of the environment;</li>
<li>provide evidence for the impacts of environmental change; or</li>
<li>predict the diversity of other species, taxa or communities within an area.</li>
</ol>
<p>In this tutorial we will show how to use the functions included in package <code>indicspecies</code> to conduct indicator species analysis. This package was originally created as a supplementary material to <span class="citation">De Cáceres and Legendre (2009)</span>, but has been developing since then and now <code>indicspecies</code> updates are distributed from CRAN at GitHub.</p>
<p>Before doing anything else, we need to load the functions of the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://emf-creaf.github.io/indicspecies">indicspecies</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: permute</span></code></pre></div>
</div>
<div id="data-required-for-indicator-species-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#data-required-for-indicator-species-analysis" class="anchor"></a>Data required for indicator species analysis</h2>
<p>Indicator species are often determined using an analysis of the relationship between the species occurrence or abundance values from a set of sampled sites and the classification of the same sites into site groups, which may represent habitat types, community types, disturbance states, etc. Thus, there are two data elements in an indicator species analysis: (1) the community data matrix; and (2) the vector that describes the classification of sites into groups.</p>
<div id="the-community-data-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#the-community-data-matrix" class="anchor"></a>The community data matrix</h3>
<p>This is a matrix (or a data frame) with sites in rows and species in columns. Normally, we will use functions like <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> to read our data set from a file. In this example we load our example dataset into the workspace using:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">wetland</span><span class="op">)</span></code></pre></div>
<p>The wetland data set describes the vegetation of the Adelaide river alluvial plain (Australia), as sampled by <span class="citation">Bowman and Wilson (1987)</span>. It contains the abundance values of 33 species (columns) in 41 sites (rows).</p>
</div>
<div id="defining-the-classification-of-sites" class="section level3">
<h3 class="hasAnchor">
<a href="#defining-the-classification-of-sites" class="anchor"></a>Defining the classification of sites</h3>
<p>In order to run an indicator species analysis we need a vector containing the classification of the sites into groups. The intepretation of these site groups is left to the user. A vector of site groups can be created, for example, using the R functions <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> and <code><a href="https://rdrr.io/r/base/rep.html">rep()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">groups</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">17</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">14</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="va">groups</span>
<span class="co">#&gt;  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3</span>
<span class="co">#&gt; [39] 3 3 3</span></code></pre></div>
<p>Alternatively, one can obtain a classification using non-hierarchical cluster analysis:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wetkm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">wetland</span>, centers<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="va">groupskm</span> <span class="op">=</span> <span class="va">wetkm</span><span class="op">$</span><span class="va">cluster</span>
<span class="va">groupskm</span>
<span class="co">#&gt;  5  8 13  4 17  3  9 21 16 14  2 15  1  7 10 40 23 25 22 20  6 18 12 39 19 11 </span>
<span class="co">#&gt;  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  2  2  2  2  2  2  2  2  2  2  2 </span>
<span class="co">#&gt; 30 34 28 31 26 29 33 24 36 37 41 27 32 35 38 </span>
<span class="co">#&gt;  3  3  3  3  2  2  2  3  3  3  3  3  3  1  1</span></code></pre></div>
<p>If the site classification vector is obtained independently of species data, the significance of statistical tests carried out on the indicator species will be meaningful. For example, one could classify the sites using environmental data before indicator species analysis. An example is found in <span class="citation">Borcard, Gillet, and Legendre (2011)</span>.</p>
</div>
</div>
<div id="indicator-species-analysis-using-multipatt" class="section level2">
<h2 class="hasAnchor">
<a href="#indicator-species-analysis-using-multipatt" class="anchor"></a>Indicator species analysis using <code>multipatt()</code>
</h2>
<p>Function <code><a href="../reference/multipatt.html">multipatt()</a></code> is the most commonly used function of <code>indicspecies</code>. It allows determining lists of species that are associated to particular groups of sites (or combinations of those). Once we have the two data components mentioned in the previous section, we are ready to run an indicator species analysis using <code><a href="../reference/multipatt.html">multipatt()</a></code>.</p>
<div id="indicator-value-analysis-with-site-group-combinations" class="section level3">
<h3 class="hasAnchor">
<a href="#indicator-value-analysis-with-site-group-combinations" class="anchor"></a>Indicator Value analysis with site group combinations</h3>
<p>When the aim is to determine which species can be used as indicators of certain site group an approach commonly used in ecology is the <em>Indicator Value</em> <span class="citation">(Dufrêne and Legendre 1997)</span>. These authors defined an Indicator Value (IndVal) index to measure the association between a species and a site group. The method of <span class="citation">Dufrêne and Legendre (1997)</span> calculates the IndVal index between the species and each site group and then looks for the group corresponding to the highest association value. Finally, the statistical significance of this relationship is tested using a permutation test. IndVal is the default index used to measure the association between a species and a group of sites in <code><a href="../reference/multipatt.html">multipatt()</a></code>. However, by default <code><a href="../reference/multipatt.html">multipatt()</a></code> uses an extension of the original Indicator Value method, because the function looks for indicator species of both individual site groups <em>and</em> combinations of site groups, as explained in <span class="citation">De Cáceres, Legendre, and Moretti (2010)</span>.</p>
<p>Indicator species analysis (with site group combinations) can be run using:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">indval</span> <span class="op">=</span> <span class="fu"><a href="../reference/multipatt.html">multipatt</a></span><span class="op">(</span><span class="va">wetland</span>, <span class="va">groups</span>, 
                   control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span>nperm<span class="op">=</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>As mentioned before, by default <code><a href="../reference/multipatt.html">multipatt()</a></code> uses the IndVal index (<code>func = "IndVal.g"</code>) as test statistic. Actually, the square root of IndVal is returned by the <code><a href="../reference/multipatt.html">multipatt()</a></code> function. The option <code>control = how(nperm=999)</code> allows choosing the number of random permutations required for the permutational test (this number affects the precision of the p-value). Function <code>how()</code> from the <code>permute</code> package allows defining more complex permutational designs.</p>
<div id="displaying-the-results" class="section level4">
<h4 class="hasAnchor">
<a href="#displaying-the-results" class="anchor"></a>Displaying the results</h4>
<p>When the indicator species analysis is completed, we can obtain the list of indicator species for each site group (or site group combination) using:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">indval</span><span class="op">)</span> 
<span class="co">#&gt; </span>
<span class="co">#&gt;  Multilevel pattern analysis</span>
<span class="co">#&gt;  ---------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Association function: IndVal.g</span>
<span class="co">#&gt;  Significance level (alpha): 0.05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total number of species: 33</span>
<span class="co">#&gt;  Selected number of species: 10 </span>
<span class="co">#&gt;  Number of species associated to 1 group: 6 </span>
<span class="co">#&gt;  Number of species associated to 2 groups: 4 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  List of species associated to each combination: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 1  #sps.  3 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Ludads 0.907   0.001 ***</span>
<span class="co">#&gt; Orysp. 0.823   0.003 ** </span>
<span class="co">#&gt; Psespi 0.602   0.017 *  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 3  #sps.  3 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Pancam 0.910   0.001 ***</span>
<span class="co">#&gt; Eupvac 0.724   0.003 ** </span>
<span class="co">#&gt; Cynarc 0.602   0.010 ** </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 1+2  #sps.  1 </span>
<span class="co">#&gt;         stat p.value   </span>
<span class="co">#&gt; Elesp. 0.741   0.005 **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 2+3  #sps.  3 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Melcor 0.876   0.001 ***</span>
<span class="co">#&gt; Phynod 0.715   0.009 ** </span>
<span class="co">#&gt; Echell 0.651   0.008 ** </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>In our wetland community data, ‘Ludads’ is strongly and significantly associated with Group 1, whereas ‘Pancam’ would be a good indicator of Group 3. In addition, there are some species whose patterns of abundance are more associated with a combination of groups. For example, ‘Melcor’ is strongly associated with the combination of Groups 2 and 3.</p>
<p>It is important to stress that the indicator species analysis is conducted for each species independently, although the results are often summarized for all species. User should bear in mind possible problems of multiple testing when making community-level statements such as ‘<em>the number of indicator species is X</em>’ <span class="citation">(De Cáceres and Legendre 2009; Legendre and Legendre 2012)</span>.</p>
</div>
<div id="examining-the-indicator-value-components" class="section level4">
<h4 class="hasAnchor">
<a href="#examining-the-indicator-value-components" class="anchor"></a>Examining the indicator value components</h4>
<p>If the association index used in <code><a href="../reference/multipatt.html">multipatt()</a></code> is <code>func = "IndVal"</code> or <code>func = "IndVal.g"</code>, one can also inspect the indicator value components when displaying the results. Indeed, the indicator value index is the product of two components, called ‘A’ and ‘B’ <span class="citation">(Dufrêne and Legendre 1997; De Cáceres and Legendre 2009)</span>:</p>
<ol style="list-style-type: decimal">
<li>Component ‘A’ is sample estimate of the probability that the surveyed site belongs to the target site group given the fact that the species has been found. This conditional probability is called the <em>specificity</em> or <em>positive predictive value</em> of the species as indicator of the site group.</li>
<li>Component ‘B’ is sample estimate of the probability of finding the species in sites belonging to the site group. This second conditional probability is called the <em>fidelity</em> or <em>sensitivity</em> of the species as indicator of the target site group.</li>
</ol>
<p>To display the indicator value components ‘A’ and ‘B’ one simply uses:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">indval</span>, indvalcomp<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Multilevel pattern analysis</span>
<span class="co">#&gt;  ---------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Association function: IndVal.g</span>
<span class="co">#&gt;  Significance level (alpha): 0.05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total number of species: 33</span>
<span class="co">#&gt;  Selected number of species: 10 </span>
<span class="co">#&gt;  Number of species associated to 1 group: 6 </span>
<span class="co">#&gt;  Number of species associated to 2 groups: 4 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  List of species associated to each combination: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 1  #sps.  3 </span>
<span class="co">#&gt;             A      B  stat p.value    </span>
<span class="co">#&gt; Ludads 1.0000 0.8235 0.907   0.001 ***</span>
<span class="co">#&gt; Orysp. 0.6772 1.0000 0.823   0.003 ** </span>
<span class="co">#&gt; Psespi 0.8811 0.4118 0.602   0.017 *  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 3  #sps.  3 </span>
<span class="co">#&gt;             A      B  stat p.value    </span>
<span class="co">#&gt; Pancam 0.8278 1.0000 0.910   0.001 ***</span>
<span class="co">#&gt; Eupvac 0.6546 0.8000 0.724   0.003 ** </span>
<span class="co">#&gt; Cynarc 0.7241 0.5000 0.602   0.010 ** </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 1+2  #sps.  1 </span>
<span class="co">#&gt;             A      B  stat p.value   </span>
<span class="co">#&gt; Elesp. 1.0000 0.5484 0.741   0.005 **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 2+3  #sps.  3 </span>
<span class="co">#&gt;             A      B  stat p.value    </span>
<span class="co">#&gt; Melcor 0.8764 0.8750 0.876   0.001 ***</span>
<span class="co">#&gt; Phynod 0.8752 0.5833 0.715   0.009 ** </span>
<span class="co">#&gt; Echell 0.9246 0.4583 0.651   0.008 ** </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>This gives us additional information about why species can be used as indicators. For example, ‘Ludads’ is a good indicator of Group 1 because it occurs in sites belonging to this group only (i.e., A = 1.0000), although not all sites belonging to Group 1 include the species (i.e., B = 0.8235). In contrast, ‘Pancam’ can be used to indicate Group 3 because it appears in all sites belonging to this group (i.e., B = 1.0000) and it is largely (but not completely) restricted to it (i.e., A = 0.8278).</p>
</div>
<div id="inspecting-the-indicator-species-analysis-results-for-all-species" class="section level4">
<h4 class="hasAnchor">
<a href="#inspecting-the-indicator-species-analysis-results-for-all-species" class="anchor"></a>Inspecting the indicator species analysis results for all species</h4>
<p>In our previous calls to <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> only the species that were significantly associated with site groups (or site group combinations) were shown. One can display the result of the indicator species analysis for all species, regardless of whether the permutational test was significant or not. This is done by changing the significance level in the summary:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">indval</span>, alpha<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Multilevel pattern analysis</span>
<span class="co">#&gt;  ---------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Association function: IndVal.g</span>
<span class="co">#&gt;  Significance level (alpha): 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total number of species: 33</span>
<span class="co">#&gt;  Selected number of species: 29 </span>
<span class="co">#&gt;  Number of species associated to 1 group: 21 </span>
<span class="co">#&gt;  Number of species associated to 2 groups: 8 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  List of species associated to each combination: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 1  #sps.  5 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Ludads 0.907   0.001 ***</span>
<span class="co">#&gt; Orysp. 0.823   0.003 ** </span>
<span class="co">#&gt; Psespi 0.602   0.017 *  </span>
<span class="co">#&gt; Polatt 0.420   0.149    </span>
<span class="co">#&gt; Casobt 0.243   1.000    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 2  #sps.  6 </span>
<span class="co">#&gt;         stat p.value</span>
<span class="co">#&gt; Aesind 0.445   0.242</span>
<span class="co">#&gt; Alyvag 0.335   0.422</span>
<span class="co">#&gt; Abefic 0.267   0.590</span>
<span class="co">#&gt; Poa2   0.267   0.595</span>
<span class="co">#&gt; Poa1   0.267   0.599</span>
<span class="co">#&gt; Helcri 0.267   0.599</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 3  #sps.  10 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Pancam 0.910   0.001 ***</span>
<span class="co">#&gt; Eupvac 0.724   0.003 ** </span>
<span class="co">#&gt; Cynarc 0.602   0.010 ** </span>
<span class="co">#&gt; Abemos 0.447   0.062 .  </span>
<span class="co">#&gt; Merhed 0.402   0.195    </span>
<span class="co">#&gt; Ludoct 0.316   0.224    </span>
<span class="co">#&gt; Passcr 0.316   0.263    </span>
<span class="co">#&gt; Dendio 0.316   0.235    </span>
<span class="co">#&gt; Physp. 0.316   0.235    </span>
<span class="co">#&gt; Goopur 0.316   0.235    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 1+2  #sps.  2 </span>
<span class="co">#&gt;         stat p.value   </span>
<span class="co">#&gt; Elesp. 0.741   0.005 **</span>
<span class="co">#&gt; Carhal 0.402   0.440   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 2+3  #sps.  6 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Melcor 0.876   0.001 ***</span>
<span class="co">#&gt; Phynod 0.715   0.009 ** </span>
<span class="co">#&gt; Echell 0.651   0.008 ** </span>
<span class="co">#&gt; Echpas 0.584   0.260    </span>
<span class="co">#&gt; Cyprot 0.500   0.080 .  </span>
<span class="co">#&gt; Ipocop 0.354   0.341    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Parameter <code>alpha</code> is by default set to <code>alpha = 0.05</code>, and hides all species association that are not significant at this level. By setting <code>alpha = 1</code> we say we want to display the group to which each species is associated, regardless of whether the association significant or not. However, note that in our example we obtain the results of 29 (21+8) species. As there are 33 species in the data set, there are still four species missing in this summary. This happens because those species have their highest IndVal value for the set of all sites. In other words, those species occur in sites belonging to all groups. The association with the set of all sites cannot be statistically tested, because there is no external group for comparison. In order to know which species are those, one has to inspect the object <code>sign</code> returned by <code><a href="../reference/multipatt.html">multipatt()</a></code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">indval</span><span class="op">$</span><span class="va">sign</span>
<span class="co">#&gt;        s.1 s.2 s.3 index      stat p.value</span>
<span class="co">#&gt; Abefic   0   1   0     2 0.2672612   0.590</span>
<span class="co">#&gt; Merhed   0   0   1     3 0.4019185   0.195</span>
<span class="co">#&gt; Alyvag   0   1   0     2 0.3347953   0.422</span>
<span class="co">#&gt; Pancam   0   0   1     3 0.9098495   0.001</span>
<span class="co">#&gt; Abemos   0   0   1     3 0.4472136   0.062</span>
<span class="co">#&gt; Melcor   0   1   1     6 0.8757059   0.001</span>
<span class="co">#&gt; Ludoct   0   0   1     3 0.3162278   0.224</span>
<span class="co">#&gt; Eupvac   0   0   1     3 0.7236825   0.003</span>
<span class="co">#&gt; Echpas   0   1   1     6 0.5842649   0.260</span>
<span class="co">#&gt; Passcr   0   0   1     3 0.3162278   0.263</span>
<span class="co">#&gt; Poa2     0   1   0     2 0.2672612   0.595</span>
<span class="co">#&gt; Carhal   1   1   0     4 0.4016097   0.440</span>
<span class="co">#&gt; Dendio   0   0   1     3 0.3162278   0.235</span>
<span class="co">#&gt; Casobt   1   0   0     1 0.2425356   1.000</span>
<span class="co">#&gt; Aesind   0   1   0     2 0.4447093   0.242</span>
<span class="co">#&gt; Cyprot   0   1   1     6 0.5000000   0.080</span>
<span class="co">#&gt; Ipocop   0   1   1     6 0.3535534   0.341</span>
<span class="co">#&gt; Cynarc   0   0   1     3 0.6017217   0.010</span>
<span class="co">#&gt; Walind   1   1   1     7 0.4938648      NA</span>
<span class="co">#&gt; Sessp.   1   1   1     7 0.6984303      NA</span>
<span class="co">#&gt; Phynod   0   1   1     6 0.7145356   0.009</span>
<span class="co">#&gt; Echell   0   1   1     6 0.6509834   0.008</span>
<span class="co">#&gt; Helind   1   1   1     7 0.6984303      NA</span>
<span class="co">#&gt; Ipoaqu   1   1   1     7 0.4938648      NA</span>
<span class="co">#&gt; Orysp.   1   0   0     1 0.8229074   0.003</span>
<span class="co">#&gt; Elesp.   1   1   0     4 0.7405316   0.005</span>
<span class="co">#&gt; Psespi   1   0   0     1 0.6023402   0.017</span>
<span class="co">#&gt; Ludads   1   0   0     1 0.9074852   0.001</span>
<span class="co">#&gt; Polatt   1   0   0     1 0.4200840   0.149</span>
<span class="co">#&gt; Poa1     0   1   0     2 0.2672612   0.599</span>
<span class="co">#&gt; Helcri   0   1   0     2 0.2672612   0.599</span>
<span class="co">#&gt; Physp.   0   0   1     3 0.3162278   0.235</span>
<span class="co">#&gt; Goopur   0   0   1     3 0.3162278   0.235</span></code></pre></div>
<p>After accessing the object <code>indval$sign</code>, we know that the four species whose highest IndVal corresponded to the set of all sites were ‘Valind’, ‘Sessp.’, ‘Helind’ and ‘Ipoaqu’, as indicated by the missing values in the <code>p.value</code> column of the data frame. The first columns of  indicate (with ones and zeroes) which site groups were included in the combination preferred by the species. Then, the column  indicates the index of the site group combination (see subsection Excluding site group combinations in <code><a href="../reference/multipatt.html">multipatt()</a></code> below). The remaining two columns are the association statistic and the p-value of the permutational test.</p>
</div>
</div>
<div id="analyzing-species-ecological-preferences-with-correlation-indices" class="section level3">
<h3 class="hasAnchor">
<a href="#analyzing-species-ecological-preferences-with-correlation-indices" class="anchor"></a>Analyzing species ecological preferences with correlation indices</h3>
<p>Several other indices can be used to analyze the association between a species and a group of sites <span class="citation">(De Cáceres and Legendre 2009)</span>. Diagnostic (or indicator) species are an important tool in vegetation science, because these species can be used to characterize and indicate specific plant community types. A statistic commonly used to determine the association (also known as <em>fidelity</em>, not to be confounded with the indicator value component) between species and vegetation types is Pearson’s <em>phi coefficient of association</em> <span class="citation">(Chytrý et al. 2002)</span>. This coefficient is a measure of the correlation between two binary vectors. It is possible to calculate the phi coefficient in <code><a href="../reference/multipatt.html">multipatt()</a></code> after transforming our community data to presence-absence:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wetlandpa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">wetland</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>
<span class="va">phi</span> <span class="op">=</span> <span class="fu"><a href="../reference/multipatt.html">multipatt</a></span><span class="op">(</span><span class="va">wetlandpa</span>, <span class="va">groups</span>, func <span class="op">=</span> <span class="st">"r"</span>, 
                control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span>nperm<span class="op">=</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>What would be the association index if we had used abundance values instead of presence and absences (i.e. <code>wetland</code> instead of <code>wetlandpa</code>)? The abundance-based counterpart of the phi coefficient is called the <em>point biserial correlation coefficient</em>.</p>
<p>It is a good practice to correct the phi coefficient for the fact that some groups have more sites than others <span class="citation">(Tichý and Chytrý 2006)</span>. To do that, we need to use <code>func = "r.g"</code> instead of <code>func = "r"</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">phi</span> <span class="op">=</span> <span class="fu"><a href="../reference/multipatt.html">multipatt</a></span><span class="op">(</span><span class="va">wetlandpa</span>, <span class="va">groups</span>, func <span class="op">=</span> <span class="st">"r.g"</span>, 
                control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span>nperm<span class="op">=</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>Remember that the default association index of <code><a href="../reference/multipatt.html">multipatt()</a></code> is <code>func = "IndVal.g"</code>, which also includes “.g”. In fact, the Indicator Value index defined by <span class="citation">Dufrêne and Legendre (1997)</span> already incorporated a correction for unequal group sizes. It is possible to avoid this correction by calling <code><a href="../reference/multipatt.html">multipatt()</a></code> with <code>func = "IndVal"</code>. However, in general we recommend using either <code>func = "IndVal.g"</code> or <code>func = "r.g"</code> for indicator species analysis.</p>
<p>Indicator value and correlation indices usually produce similar results. Indeed, if we display the results of the phi coefficient of association we see that they are qualitatively similar to those of IndVal:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Multilevel pattern analysis</span>
<span class="co">#&gt;  ---------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Association function: r.g</span>
<span class="co">#&gt;  Significance level (alpha): 0.05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total number of species: 33</span>
<span class="co">#&gt;  Selected number of species: 9 </span>
<span class="co">#&gt;  Number of species associated to 1 group: 7 </span>
<span class="co">#&gt;  Number of species associated to 2 groups: 2 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  List of species associated to each combination: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 1  #sps.  3 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Ludads 0.870   0.001 ***</span>
<span class="co">#&gt; Orysp. 0.668   0.001 ***</span>
<span class="co">#&gt; Psespi 0.413   0.016 *  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 2  #sps.  1 </span>
<span class="co">#&gt;         stat p.value  </span>
<span class="co">#&gt; Phynod 0.436   0.011 *</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 3  #sps.  3 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Pancam 0.748   0.001 ***</span>
<span class="co">#&gt; Eupvac 0.537   0.008 ** </span>
<span class="co">#&gt; Cynarc 0.492   0.012 *  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 1+2  #sps.  1 </span>
<span class="co">#&gt;         stat p.value   </span>
<span class="co">#&gt; Elesp. 0.538   0.003 **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 2+3  #sps.  1 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Melcor 0.612   0.001 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Nevertheless, there are some differences between indicator values and correlation indices <span class="citation">(De Cáceres, Font, and Oliva 2008; De Cáceres and Legendre 2009)</span>. Correlation indices are used for determining the ecological preferences of species among a set of alternative site groups or site group combinations. Indicator value indices are used for assessing the predictive values of species as indicators of the conditions prevailing in site groups, e.g. for field determination of community types or ecological monitoring.</p>
<p>An advantage of the phi and point biserial coefficients is that they can take negative values. When this happens, the value of the index is expressing the fact that a species tends to ‘avoid’ particular environmental conditions. We will find negative association values if we inspect the strength of association in the results of <code><a href="../reference/multipatt.html">multipatt()</a></code> when these coefficients are used:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">phi</span><span class="op">$</span><span class="va">str</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;             1      2      3    1+2    1+3   2+3</span>
<span class="co">#&gt; Abefic -0.110  0.221 -0.110  0.110 -0.221 0.110</span>
<span class="co">#&gt; Merhed -0.223 -0.047  0.270 -0.270  0.047 0.223</span>
<span class="co">#&gt; Alyvag -0.024  0.214 -0.190  0.190 -0.214 0.024</span>
<span class="co">#&gt; Pancam -0.585 -0.163  0.748 -0.748  0.163 0.585</span>
<span class="co">#&gt; Abemos -0.189 -0.189  0.378 -0.378  0.189 0.189</span>
<span class="co">#&gt; Melcor -0.612  0.142  0.470 -0.470 -0.142 0.612</span></code></pre></div>
<p>In contrast, indicator values are always non-negative:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">indval</span><span class="op">$</span><span class="va">str</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;            1     2     3   1+2   1+3   2+3 1+2+3</span>
<span class="co">#&gt; Abefic 0.000 0.267 0.000 0.180 0.000 0.204 0.156</span>
<span class="co">#&gt; Merhed 0.000 0.117 0.402 0.079 0.245 0.354 0.271</span>
<span class="co">#&gt; Alyvag 0.113 0.335 0.000 0.311 0.089 0.256 0.271</span>
<span class="co">#&gt; Pancam 0.038 0.230 0.910 0.183 0.589 0.781 0.625</span>
<span class="co">#&gt; Abemos 0.000 0.000 0.447 0.000 0.272 0.289 0.221</span>
<span class="co">#&gt; Melcor 0.191 0.509 0.739 0.484 0.610 0.876 0.796</span></code></pre></div>
<p>Unlike with indicator value coefficients, the set of all sites can never be considered with the phi or point biserial coefficients, because these coefficients always require a set of sites for comparison, besides the target site group or site group combination of interest.</p>
</div>
<div id="excluding-site-group-combinations-in-multipatt" class="section level3">
<h3 class="hasAnchor">
<a href="#excluding-site-group-combinations-in-multipatt" class="anchor"></a>Excluding site group combinations in <code>multipatt()</code>
</h3>
<p>When conducting indicator species analysis, it may happen that some combinations of site groups are difficult to interpret ecologically. In those cases, we may decide to exclude those combinations from the analysis, so our species may appear associated to other (more interpretable) ecological conditions. There are three ways to restrict the site group combinations to be considered in <code><a href="../reference/multipatt.html">multipatt()</a></code>.</p>
<div id="indicator-species-analysis-without-site-groups-combinations" class="section level4">
<h4 class="hasAnchor">
<a href="#indicator-species-analysis-without-site-groups-combinations" class="anchor"></a>Indicator species analysis without site groups combinations</h4>
<p>The original Indicator Value method of <span class="citation">Dufrêne and Legendre (1997)</span> did not consider combinations of site groups. In other words, the only site group combinations permitted in the original method were singletons. When using <code><a href="../reference/multipatt.html">multipatt()</a></code> it is possible to avoid considering site group combinations, as in the original method, by using <code>duleg = TRUE</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">indvalori</span> <span class="op">=</span> <span class="fu"><a href="../reference/multipatt.html">multipatt</a></span><span class="op">(</span><span class="va">wetland</span>, <span class="va">groups</span>, duleg <span class="op">=</span> <span class="cn">TRUE</span>, 
                      control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span>nperm<span class="op">=</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">indvalori</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Multilevel pattern analysis</span>
<span class="co">#&gt;  ---------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Association function: IndVal.g</span>
<span class="co">#&gt;  Significance level (alpha): 0.05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total number of species: 33</span>
<span class="co">#&gt;  Selected number of species: 9 </span>
<span class="co">#&gt;  Number of species associated to 1 group: 9 </span>
<span class="co">#&gt;  Number of species associated to 2 groups: 0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  List of species associated to each combination: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 1  #sps.  3 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Ludads 0.907   0.001 ***</span>
<span class="co">#&gt; Orysp. 0.823   0.001 ***</span>
<span class="co">#&gt; Psespi 0.602   0.014 *  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 2  #sps.  1 </span>
<span class="co">#&gt;         stat p.value   </span>
<span class="co">#&gt; Phynod 0.676   0.006 **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 3  #sps.  5 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Pancam 0.910   0.001 ***</span>
<span class="co">#&gt; Melcor 0.739   0.001 ***</span>
<span class="co">#&gt; Eupvac 0.724   0.002 ** </span>
<span class="co">#&gt; Cynarc 0.602   0.014 *  </span>
<span class="co">#&gt; Abemos 0.447   0.040 *  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
</div>
<div id="restricting-the-order-of-site-groups-combinations" class="section level4">
<h4 class="hasAnchor">
<a href="#restricting-the-order-of-site-groups-combinations" class="anchor"></a>Restricting the order of site groups combinations</h4>
<p>The second way to exclude site group combinations from a <code><a href="../reference/multipatt.html">multipatt()</a></code> analysis is to indicate the maximum order of the combination to be considered. Using the option <code>max.order</code> we can restrict site group combinations to be, for example, singletons (<code>max.order = 1</code>, which is equal to <code>duleg=TRUE</code>), singletons and pairs (<code>max.order = 2</code>), or singletons, pairs and triplets (<code>max.order = 3</code>). In the follow example, only singletons and pairs are considered:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">indvalrest</span> <span class="op">=</span> <span class="fu"><a href="../reference/multipatt.html">multipatt</a></span><span class="op">(</span><span class="va">wetland</span>, <span class="va">groups</span>, max.order <span class="op">=</span> <span class="fl">2</span>, 
                       control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span>nperm<span class="op">=</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">indvalrest</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Multilevel pattern analysis</span>
<span class="co">#&gt;  ---------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Association function: IndVal.g</span>
<span class="co">#&gt;  Significance level (alpha): 0.05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total number of species: 33</span>
<span class="co">#&gt;  Selected number of species: 10 </span>
<span class="co">#&gt;  Number of species associated to 1 group: 6 </span>
<span class="co">#&gt;  Number of species associated to 2 groups: 4 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  List of species associated to each combination: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 1  #sps.  3 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Ludads 0.907   0.001 ***</span>
<span class="co">#&gt; Orysp. 0.823   0.002 ** </span>
<span class="co">#&gt; Psespi 0.602   0.017 *  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 3  #sps.  3 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Pancam 0.910   0.001 ***</span>
<span class="co">#&gt; Eupvac 0.724   0.006 ** </span>
<span class="co">#&gt; Cynarc 0.602   0.010 ** </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 1+2  #sps.  1 </span>
<span class="co">#&gt;         stat p.value   </span>
<span class="co">#&gt; Elesp. 0.741   0.006 **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 2+3  #sps.  3 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Melcor 0.876   0.001 ***</span>
<span class="co">#&gt; Phynod 0.715   0.005 ** </span>
<span class="co">#&gt; Echell 0.651   0.019 *  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>In this case the output looks like a the output of an unrestricted <code><a href="../reference/multipatt.html">multipatt()</a></code> execution, because the only combination that is excluded is the set of all sites, which cannot be tested for significance and thus never appears in the summary.</p>
</div>
<div id="specifying-the-site-groups-combinations-to-be-considered" class="section level4">
<h4 class="hasAnchor">
<a href="#specifying-the-site-groups-combinations-to-be-considered" class="anchor"></a>Specifying the site groups combinations to be considered</h4>
<p>There is a third, more flexible, way of restricting site group combinations. The input parameter vector <code>restcomb</code> allows specifying the combinations of site groups that are permitted in <code><a href="../reference/multipatt.html">multipatt()</a></code>. In order to learn how to use parameter <code>restcomb</code>, we must first understand that inside <code><a href="../reference/multipatt.html">multipatt()</a></code> site groups and site group combinations are referred to with integers. Site group combinations are numbered starting with single groups and then increasing the order of combinations. For example, if there are three site groups, the first three integers ‘1’ to ‘3’ identify those groups. Then, ‘4’ identifies the combination of Group 1 and Group 2, ‘5’ identifies the combination of Group 1 and Group 3, and ‘6’ identifies the combination of Group 2 and Group 3. Finally, ‘7’ identifies the combination of all three groups.</p>
<p>The numbers composing the vector passed to <code>restcomb</code> indicate the site groups and site group combinations that we want <code><a href="../reference/multipatt.html">multipatt()</a></code> to considered as valid options. For example, if we do not want to consider the combination of Group 1 and Group 2, we will exclude combination ‘4’ from vector <code>restcomb</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">indvalrest</span> <span class="op">=</span> <span class="fu"><a href="../reference/multipatt.html">multipatt</a></span><span class="op">(</span><span class="va">wetland</span>, <span class="va">groups</span>, restcomb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>, 
                       control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span>nperm<span class="op">=</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">indvalrest</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Multilevel pattern analysis</span>
<span class="co">#&gt;  ---------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Association function: IndVal.g</span>
<span class="co">#&gt;  Significance level (alpha): 0.05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total number of species: 33</span>
<span class="co">#&gt;  Selected number of species: 9 </span>
<span class="co">#&gt;  Number of species associated to 1 group: 6 </span>
<span class="co">#&gt;  Number of species associated to 2 groups: 3 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  List of species associated to each combination: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 1  #sps.  3 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Ludads 0.907   0.001 ***</span>
<span class="co">#&gt; Orysp. 0.823   0.003 ** </span>
<span class="co">#&gt; Psespi 0.602   0.019 *  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 3  #sps.  3 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Pancam 0.910   0.001 ***</span>
<span class="co">#&gt; Eupvac 0.724   0.004 ** </span>
<span class="co">#&gt; Cynarc 0.602   0.008 ** </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 2+3  #sps.  3 </span>
<span class="co">#&gt;         stat p.value    </span>
<span class="co">#&gt; Melcor 0.876   0.001 ***</span>
<span class="co">#&gt; Phynod 0.715   0.004 ** </span>
<span class="co">#&gt; Echell 0.651   0.013 *  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>If we compare these last results with those including all possible site group combinations, we will realize that species ‘Elesp.’ was formerly an indicator of Group 1 and Group 2, and now it does not appear in the list of indicator species. If fact, if we examine the results more closely we see that the highest IndVal for ‘Elesp’ is achieved for group 1, but this relationship is not significant:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">indvalrest</span><span class="op">$</span><span class="va">sign</span>
<span class="co">#&gt;        s.1 s.2 s.3 index      stat p.value</span>
<span class="co">#&gt; Abefic   0   1   0     2 0.2672612   0.559</span>
<span class="co">#&gt; Merhed   0   0   1     3 0.4019185   0.231</span>
<span class="co">#&gt; Alyvag   0   1   0     2 0.3347953   0.448</span>
<span class="co">#&gt; Pancam   0   0   1     3 0.9098495   0.001</span>
<span class="co">#&gt; Abemos   0   0   1     3 0.4472136   0.061</span>
<span class="co">#&gt; Melcor   0   1   1     5 0.8757059   0.001</span>
<span class="co">#&gt; Ludoct   0   0   1     3 0.3162278   0.253</span>
<span class="co">#&gt; Eupvac   0   0   1     3 0.7236825   0.004</span>
<span class="co">#&gt; Echpas   0   1   1     5 0.5842649   0.211</span>
<span class="co">#&gt; Passcr   0   0   1     3 0.3162278   0.223</span>
<span class="co">#&gt; Poa2     0   1   0     2 0.2672612   0.622</span>
<span class="co">#&gt; Carhal   1   0   0     1 0.3313667   0.738</span>
<span class="co">#&gt; Dendio   0   0   1     3 0.3162278   0.226</span>
<span class="co">#&gt; Casobt   1   0   0     1 0.2425356   1.000</span>
<span class="co">#&gt; Aesind   0   1   0     2 0.4447093   0.227</span>
<span class="co">#&gt; Cyprot   0   1   1     5 0.5000000   0.065</span>
<span class="co">#&gt; Ipocop   0   1   1     5 0.3535534   0.321</span>
<span class="co">#&gt; Cynarc   0   0   1     3 0.6017217   0.008</span>
<span class="co">#&gt; Walind   1   0   1     4 0.4406873   0.701</span>
<span class="co">#&gt; Sessp.   0   1   1     5 0.5901665   0.713</span>
<span class="co">#&gt; Phynod   0   1   1     5 0.7145356   0.004</span>
<span class="co">#&gt; Echell   0   1   1     5 0.6509834   0.013</span>
<span class="co">#&gt; Helind   0   1   1     5 0.5720540   0.824</span>
<span class="co">#&gt; Ipoaqu   1   0   1     4 0.4053049   0.927</span>
<span class="co">#&gt; Orysp.   1   0   0     1 0.8229074   0.003</span>
<span class="co">#&gt; Elesp.   1   0   0     1 0.5534178   0.646</span>
<span class="co">#&gt; Psespi   1   0   0     1 0.6023402   0.019</span>
<span class="co">#&gt; Ludads   1   0   0     1 0.9074852   0.001</span>
<span class="co">#&gt; Polatt   1   0   0     1 0.4200840   0.145</span>
<span class="co">#&gt; Poa1     0   1   0     2 0.2672612   0.617</span>
<span class="co">#&gt; Helcri   0   1   0     2 0.2672612   0.617</span>
<span class="co">#&gt; Physp.   0   0   1     3 0.3162278   0.256</span>
<span class="co">#&gt; Goopur   0   0   1     3 0.3162278   0.256</span></code></pre></div>
<p>Restricting site group combinations is also possible with the phi and point biserial coefficients.</p>
</div>
</div>
</div>
<div id="additional-functions-to-estimate-and-test-the-association-between-species-and-groups-of-sites" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-functions-to-estimate-and-test-the-association-between-species-and-groups-of-sites" class="anchor"></a>Additional functions to estimate and test the association between species and groups of sites</h2>
<p>Although <code><a href="../reference/multipatt.html">multipatt()</a></code> is a user-friendly function for indicator species analysis, other functions are also useful to study the association between species and site groups.</p>
<div id="the-function-strassoc" class="section level3">
<h3 class="hasAnchor">
<a href="#the-function-strassoc" class="anchor"></a>The function <code>strassoc()</code>
</h3>
<p>Function <code><a href="../reference/strassoc.html">strassoc()</a></code> allows calculating a broad hand of association indices, described in <span class="citation">De Cáceres and Legendre (2009)</span>. For example, we can focus on the ‘A’ component of IndVal:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prefstat</span> <span class="op">=</span> <span class="fu"><a href="../reference/strassoc.html">strassoc</a></span><span class="op">(</span><span class="va">wetland</span>, cluster<span class="op">=</span><span class="va">groups</span>, func<span class="op">=</span><span class="st">"A.g"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">prefstat</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;            1     2     3</span>
<span class="co">#&gt; Abefic 0.000 1.000 0.000</span>
<span class="co">#&gt; Merhed 0.000 0.192 0.808</span>
<span class="co">#&gt; Alyvag 0.215 0.785 0.000</span>
<span class="co">#&gt; Pancam 0.024 0.148 0.828</span>
<span class="co">#&gt; Abemos 0.000 0.000 1.000</span>
<span class="co">#&gt; Melcor 0.124 0.330 0.546</span></code></pre></div>
<p>A feature of <code><a href="../reference/strassoc.html">strassoc()</a></code> that is lacking in <code><a href="../reference/multipatt.html">multipatt()</a></code> is the possibility to obtain confidence interval limits by bootstrapping. In this case, the function returns a list with three elements: <code>stat</code>, <code>lowerCI</code> and <code>upperCI</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prefstat</span> <span class="op">=</span> <span class="fu"><a href="../reference/strassoc.html">strassoc</a></span><span class="op">(</span><span class="va">wetland</span>, cluster<span class="op">=</span><span class="va">groups</span>, func<span class="op">=</span><span class="st">"A.g"</span>, 
                    nboot.ci <span class="op">=</span> <span class="fl">199</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">prefstat</span><span class="op">$</span><span class="va">lowerCI</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;            1     2     3</span>
<span class="co">#&gt; Abefic 0.000 0.000 0.000</span>
<span class="co">#&gt; Merhed 0.000 0.000 0.000</span>
<span class="co">#&gt; Alyvag 0.000 0.000 0.000</span>
<span class="co">#&gt; Pancam 0.000 0.036 0.671</span>
<span class="co">#&gt; Abemos 0.000 0.000 0.000</span>
<span class="co">#&gt; Melcor 0.045 0.245 0.462</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">prefstat</span><span class="op">$</span><span class="va">upperCI</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;            1     2     3</span>
<span class="co">#&gt; Abefic 0.000 1.000 0.000</span>
<span class="co">#&gt; Merhed 0.000 1.000 1.000</span>
<span class="co">#&gt; Alyvag 1.000 1.000 0.000</span>
<span class="co">#&gt; Pancam 0.088 0.271 0.941</span>
<span class="co">#&gt; Abemos 0.000 0.000 1.000</span>
<span class="co">#&gt; Melcor 0.203 0.414 0.644</span></code></pre></div>
<p>For example, the 95% confidence interval for the ‘A’ component of the association between ‘Pancam’ and Group 3 is [0.671, 0.941].</p>
</div>
<div id="the-function-signassoc" class="section level3">
<h3 class="hasAnchor">
<a href="#the-function-signassoc" class="anchor"></a>The function <code>signassoc()</code>
</h3>
<p>As we explained before, <code><a href="../reference/multipatt.html">multipatt()</a></code> statistically tests the association between the species and its more strongly associated site group (or site group combination). By contrast, <code><a href="../reference/signassoc.html">signassoc()</a></code> allows one to test the association between the species and each group of sites, regardless of whether the association value was the highest or not. Moreover, the function allows one to test both one-sided and two-sided hypotheses. For example, the following line tests whether the frequency of the species in each site group is higher or lower than random:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prefsign</span> <span class="op">=</span> <span class="fu"><a href="../reference/signassoc.html">signassoc</a></span><span class="op">(</span><span class="va">wetland</span>, cluster<span class="op">=</span><span class="va">groups</span>,  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, 
                     control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span>nperm<span class="op">=</span><span class="fl">199</span><span class="op">)</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">prefsign</span><span class="op">)</span>
<span class="co">#&gt;           1    2    3 best   psidak</span>
<span class="co">#&gt; Abefic 1.00 0.65 1.00    2 0.957125</span>
<span class="co">#&gt; Merhed 0.44 0.66 0.22    3 0.525448</span>
<span class="co">#&gt; Alyvag 0.93 0.23 0.89    2 0.543467</span>
<span class="co">#&gt; Pancam 0.01 0.22 0.01    1 0.029701</span>
<span class="co">#&gt; Abemos 0.67 0.87 0.15    3 0.385875</span>
<span class="co">#&gt; Melcor 0.01 0.83 0.01    1 0.029701</span></code></pre></div>
<p>The last columns of the results indicate the group for which the p-value was the lowest, and the p-value corrected for multiple testing using the Sidak method.</p>
</div>
</div>
<div id="determining-how-well-target-site-groups-are-covered-by-indicators" class="section level2">
<h2 class="hasAnchor">
<a href="#determining-how-well-target-site-groups-are-covered-by-indicators" class="anchor"></a>Determining how well target site groups are covered by indicators</h2>
<p>Besides knowing what species can be useful indicators of site groups (or site group combinations), it is sometimes useful to know <em>the proportion of sites of a given site group where one or another indicator is found</em>. We call this quantity <em>coverage</em> of the site group. Determining the coverage of site groups can be useful for habitat or vegetation types encompassing a broad geographic area <span class="citation">(De Cáceres et al. 2012)</span>, because there may exist some areas where none of the valid indicators can be found.</p>
<div id="the-function-coverage" class="section level3">
<h3 class="hasAnchor">
<a href="#the-function-coverage" class="anchor"></a>The function <code>coverage()</code>
</h3>
<p>The coverage can be calculated for all the site groups of a <code><a href="../reference/multipatt.html">multipatt()</a></code> object using the function <code><a href="../reference/coverage.html">coverage()</a></code>:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/coverage.html">coverage</a></span><span class="op">(</span><span class="va">wetland</span>, <span class="va">indvalori</span><span class="op">)</span>
<span class="co">#&gt; 1 2 3 </span>
<span class="co">#&gt; 1 1 1</span></code></pre></div>
<p>Note that to obtain the coverage we need to input both the community data set and the object of class <code><a href="../reference/multipatt.html">multipatt()</a></code>. In this case the coverage was complete (i.e. 100%) for site groups ‘1’ and ‘3’. In contrast, group ‘2’ has a lower coverage because only one species, ‘Phynod’, can be considered indicator of the site group, and this species does not always occur in sites of the group.</p>
<p>The coverage of site groups depends on how many and which indicators are considered as valid. Statistical significance (i.e., <code>alpha</code>) determined in <code><a href="../reference/multipatt.html">multipatt()</a></code> can be used to determine what indicators are valid, but we can add more requirements to the validity of indicator species by specifying additional parameters to the function <code><a href="../reference/coverage.html">coverage()</a></code>. For example, if we want to know the coverage of our site groups with indicators that are significant and whose ‘A’ value is equal or higher than 0.8, we can use:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/coverage.html">coverage</a></span><span class="op">(</span><span class="va">wetland</span>, <span class="va">indvalori</span>, At <span class="op">=</span> <span class="fl">0.8</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="co">#&gt;         1         2         3 </span>
<span class="co">#&gt; 0.8235294 0.0000000 1.0000000</span></code></pre></div>
<p>Note that, after adding this extra requirement, group ‘2’ has 0% coverage and the coverage of group ‘1’ has also decreased.</p>
</div>
<div id="the-function-plotcoverage" class="section level3">
<h3 class="hasAnchor">
<a href="#the-function-plotcoverage" class="anchor"></a>The function <code>plotcoverage()</code>
</h3>
<p>It is possible to know how the coverage changes with ‘A’ threshold used to select good indicators. This is obtained by drawing the coverage values corresponding to different threshold values. This is what the <code><a href="../reference/coverage.html">plotcoverage()</a></code> function does for us:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/coverage.html">plotcoverage</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">wetland</span>, y<span class="op">=</span><span class="va">indvalori</span>, group<span class="op">=</span><span class="st">"1"</span>, lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="../reference/coverage.html">plotcoverage</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">wetland</span>, y<span class="op">=</span><span class="va">indvalori</span>, group<span class="op">=</span><span class="st">"2"</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"blue"</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="../reference/coverage.html">plotcoverage</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">wetland</span>, y<span class="op">=</span><span class="va">indvalori</span>, group<span class="op">=</span><span class="st">"3"</span>, lty<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"red"</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.1</span>, y<span class="op">=</span><span class="fl">30</span>, 
       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"group 1"</span>,<span class="st">"group 2"</span>, <span class="st">"group 3"</span><span class="op">)</span>,
       lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"blue"</span>,<span class="st">"red"</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="IndicatorSpeciesAnalysis_files/figure-html/unnamed-chunk-24-1.png" width="480"></p>
<p>As you can see in the example, function <code><a href="../reference/coverage.html">plotcoverage()</a></code> has to be called for one group at a time. However, several plots can be drawn one onto the other using the option <code>add=TRUE</code>.</p>
</div>
</div>
<div id="species-combinations-as-indicators-of-site-groups" class="section level2">
<h2 class="hasAnchor">
<a href="#species-combinations-as-indicators-of-site-groups" class="anchor"></a>Species combinations as indicators of site groups</h2>
<p>Ecological indicators can be of many kinds. <span class="citation">De Cáceres et al. (2012)</span> recently explored the indicator value of <em>combinations of species</em> instead of just considering individual species. The rationale behind this approach is that two or three species, when found together, bear more ecological information than a single one.</p>
<div id="generating-species-combinations" class="section level3">
<h3 class="hasAnchor">
<a href="#generating-species-combinations" class="anchor"></a>Generating species combinations</h3>
<p>The association between species combinations and groups of sites is studied in the same way as for individual species. However, instead of analyzing a site-by-species matrix, we need a matrix with as many rows as there are sites and as many columns as there are species combinations. We can obtain that matrix using the function <code><a href="../reference/combinespecies.html">combinespecies()</a></code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wetcomb</span> <span class="op">=</span> <span class="fu"><a href="../reference/combinespecies.html">combinespecies</a></span><span class="op">(</span><span class="va">wetland</span>, max.order <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">XC</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">wetcomb</span><span class="op">)</span>
<span class="co">#&gt; [1]  41 286</span></code></pre></div>
<p>The resulting data frame has the same number of sites (i.e. 41) but as many columns as species combinations (in this case 41 columns). Each element of the data frame contains an abundance value, which is the minimum abundance value among all the species forming the combination, for the corresponding site. In our example, we used <code>max.order = 2</code> to limit the order of combinations. Therefore, only pairs of species were considered. Once we have this new data set, we can use it in <code><a href="../reference/multipatt.html">multipatt()</a></code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">indvalspcomb</span> <span class="op">=</span> <span class="fu"><a href="../reference/multipatt.html">multipatt</a></span><span class="op">(</span><span class="va">wetcomb</span>, <span class="va">groups</span>, duleg <span class="op">=</span> <span class="cn">TRUE</span>, 
                       control <span class="op">=</span> <span class="fu">how</span><span class="op">(</span>nperm<span class="op">=</span><span class="fl">999</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">indvalspcomb</span>, indvalcomp <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Multilevel pattern analysis</span>
<span class="co">#&gt;  ---------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Association function: IndVal.g</span>
<span class="co">#&gt;  Significance level (alpha): 0.05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total number of species: 286</span>
<span class="co">#&gt;  Selected number of species: 42 </span>
<span class="co">#&gt;  Number of species associated to 1 group: 42 </span>
<span class="co">#&gt;  Number of species associated to 2 groups: 0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  List of species associated to each combination: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 1  #sps.  14 </span>
<span class="co">#&gt;                    A      B  stat p.value    </span>
<span class="co">#&gt; Orysp.+Ludads 1.0000 0.8235 0.907   0.001 ***</span>
<span class="co">#&gt; Ludads        1.0000 0.8235 0.907   0.001 ***</span>
<span class="co">#&gt; Orysp.        0.6772 1.0000 0.823   0.001 ***</span>
<span class="co">#&gt; Sessp.+Ludads 1.0000 0.4118 0.642   0.001 ***</span>
<span class="co">#&gt; Orysp.+Psespi 1.0000 0.4118 0.642   0.006 ** </span>
<span class="co">#&gt; Elesp.+Ludads 1.0000 0.4118 0.642   0.004 ** </span>
<span class="co">#&gt; Psespi+Ludads 1.0000 0.4118 0.642   0.004 ** </span>
<span class="co">#&gt; Orysp.+Elesp. 0.7424 0.5294 0.627   0.016 *  </span>
<span class="co">#&gt; Sessp.+Orysp. 0.9081 0.4118 0.611   0.007 ** </span>
<span class="co">#&gt; Psespi        0.8811 0.4118 0.602   0.009 ** </span>
<span class="co">#&gt; Helind+Ludads 1.0000 0.3529 0.594   0.011 *  </span>
<span class="co">#&gt; Walind+Orysp. 1.0000 0.2941 0.542   0.020 *  </span>
<span class="co">#&gt; Walind+Ludads 1.0000 0.2941 0.542   0.020 *  </span>
<span class="co">#&gt; Ipoaqu+Ludads 1.0000 0.2941 0.542   0.018 *  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 2  #sps.  10 </span>
<span class="co">#&gt;                    A      B  stat p.value    </span>
<span class="co">#&gt; Phynod+Elesp. 0.9162 0.5714 0.724   0.001 ***</span>
<span class="co">#&gt; Phynod        0.6396 0.7143 0.676   0.006 ** </span>
<span class="co">#&gt; Phynod+Helind 0.6922 0.6429 0.667   0.003 ** </span>
<span class="co">#&gt; Helind+Elesp. 0.6861 0.5714 0.626   0.013 *  </span>
<span class="co">#&gt; Phynod+Echell 0.8654 0.3571 0.556   0.018 *  </span>
<span class="co">#&gt; Echell+Elesp. 0.8586 0.3571 0.554   0.021 *  </span>
<span class="co">#&gt; Aesind+Elesp. 1.0000 0.2857 0.535   0.007 ** </span>
<span class="co">#&gt; Echpas+Phynod 0.8293 0.2857 0.487   0.041 *  </span>
<span class="co">#&gt; Eupvac+Cyprot 1.0000 0.2143 0.463   0.039 *  </span>
<span class="co">#&gt; Echpas+Cyprot 1.0000 0.2143 0.463   0.048 *  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Group 3  #sps.  18 </span>
<span class="co">#&gt;                    A      B  stat p.value    </span>
<span class="co">#&gt; Pancam        0.8278 1.0000 0.910   0.001 ***</span>
<span class="co">#&gt; Pancam+Melcor 0.7769 1.0000 0.881   0.001 ***</span>
<span class="co">#&gt; Pancam+Echell 1.0000 0.6000 0.775   0.001 ***</span>
<span class="co">#&gt; Eupvac+Echell 1.0000 0.6000 0.775   0.001 ***</span>
<span class="co">#&gt; Pancam+Eupvac 0.7455 0.8000 0.772   0.001 ***</span>
<span class="co">#&gt; Melcor        0.5463 1.0000 0.739   0.001 ***</span>
<span class="co">#&gt; Melcor+Eupvac 0.6648 0.8000 0.729   0.004 ** </span>
<span class="co">#&gt; Eupvac        0.6546 0.8000 0.724   0.001 ***</span>
<span class="co">#&gt; Pancam+Cynarc 1.0000 0.5000 0.707   0.001 ***</span>
<span class="co">#&gt; Pancam+Sessp. 0.8077 0.6000 0.696   0.001 ***</span>
<span class="co">#&gt; Melcor+Echell 0.7368 0.6000 0.665   0.004 ** </span>
<span class="co">#&gt; Melcor+Cynarc 0.8077 0.5000 0.635   0.005 ** </span>
<span class="co">#&gt; Cynarc        0.7241 0.5000 0.602   0.011 *  </span>
<span class="co">#&gt; Melcor+Sessp. 0.5895 0.6000 0.595   0.034 *  </span>
<span class="co">#&gt; Eupvac+Cynarc 0.8485 0.4000 0.583   0.015 *  </span>
<span class="co">#&gt; Cynarc+Sessp. 0.7778 0.4000 0.558   0.029 *  </span>
<span class="co">#&gt; Cynarc+Phynod 1.0000 0.3000 0.548   0.016 *  </span>
<span class="co">#&gt; Cynarc+Echell 1.0000 0.3000 0.548   0.011 *  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>The best indicators for both Group 1 and Group 3 are individual species (‘Ludads’ and ‘Pancam’). However, Group 2 is best indicated if we find, in the same community, ‘Phynod’ and ‘Elesp’. Note that the species forming the indicator combination do not need to be good single-species indicators themselves. In our example ‘Phynod’ is a good indicator of Group 2 but ‘Elesp.’ is not. As an aside, note that we used the option <code>duleg=TRUE</code> in this last example, hence excluding site group combinations, for simplicity.</p>
</div>
<div id="the-function-indicators" class="section level3">
<h3 class="hasAnchor">
<a href="#the-function-indicators" class="anchor"></a>The function <code>indicators()</code>
</h3>
<p>In the previous example, there were many combinations of species that were significantly associated any of the site groups. There is another, more efficient, way of exploring the potential indicators for a given target site group. Say, for example, that we want to determine indicators for our Group 2, and we want to consider not only species pairs but also species trios. We can run the indicator analysis using:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sc</span><span class="op">=</span> <span class="fu"><a href="../reference/indicators.html">indicators</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">wetland</span>, cluster<span class="op">=</span><span class="va">groups</span>, group<span class="op">=</span><span class="fl">2</span>, 
               max.order <span class="op">=</span> <span class="fl">3</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>, 
               At<span class="op">=</span><span class="fl">0.5</span>, Bt<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>
<span class="co">#&gt; Target site group: 2</span>
<span class="co">#&gt; Number of candidate species: 33</span>
<span class="co">#&gt; Number of sites: 41 </span>
<span class="co">#&gt; Size of the site group: 14 </span>
<span class="co">#&gt; Starting species  1 ... accepted combinations: 0 </span>
<span class="co">#&gt; Starting species  2 ... accepted combinations: 0 </span>
<span class="co">#&gt; Starting species  3 ... accepted combinations: 0 </span>
<span class="co">#&gt; Starting species  4 ... accepted combinations: 3 </span>
<span class="co">#&gt; Starting species  5 ... accepted combinations: 3 </span>
<span class="co">#&gt; Starting species  6 ... accepted combinations: 24 </span>
<span class="co">#&gt; Starting species  7 ... accepted combinations: 24 </span>
<span class="co">#&gt; Starting species  8 ... accepted combinations: 27 </span>
<span class="co">#&gt; Starting species  9 ... accepted combinations: 34 </span>
<span class="co">#&gt; Starting species  10 ... accepted combinations: 34 </span>
<span class="co">#&gt; Starting species  11 ... accepted combinations: 34 </span>
<span class="co">#&gt; Starting species  12 ... accepted combinations: 34 </span>
<span class="co">#&gt; Starting species  13 ... accepted combinations: 34 </span>
<span class="co">#&gt; Starting species  14 ... accepted combinations: 34 </span>
<span class="co">#&gt; Starting species  15 ... accepted combinations: 45 </span>
<span class="co">#&gt; Starting species  16 ... accepted combinations: 49 </span>
<span class="co">#&gt; Starting species  17 ... accepted combinations: 49 </span>
<span class="co">#&gt; Starting species  18 ... accepted combinations: 49 </span>
<span class="co">#&gt; Starting species  19 ... accepted combinations: 49 </span>
<span class="co">#&gt; Starting species  20 ... accepted combinations: 53 </span>
<span class="co">#&gt; Starting species  21 ... accepted combinations: 66 </span>
<span class="co">#&gt; Starting species  22 ... accepted combinations: 69 </span>
<span class="co">#&gt; Starting species  23 ... accepted combinations: 72 </span>
<span class="co">#&gt; Starting species  24 ... accepted combinations: 73 </span>
<span class="co">#&gt; Starting species  25 ... accepted combinations: 73 </span>
<span class="co">#&gt; Starting species  26 ... accepted combinations: 73 </span>
<span class="co">#&gt; Starting species  27 ... accepted combinations: 73 </span>
<span class="co">#&gt; Starting species  28 ... accepted combinations: 73 </span>
<span class="co">#&gt; Starting species  29 ... accepted combinations: 73 </span>
<span class="co">#&gt; Starting species  30 ... accepted combinations: 73 </span>
<span class="co">#&gt; Starting species  31 ... accepted combinations: 73 </span>
<span class="co">#&gt; Starting species  32 ... accepted combinations: 73 </span>
<span class="co">#&gt; Starting species  33 ... accepted combinations: 73 </span>
<span class="co">#&gt; Number of valid combinations: 73</span>
<span class="co">#&gt; Number of remaining species: 14 </span>
<span class="co">#&gt; Calculating statistical significance (permutational test)...</span></code></pre></div>
<p>We can discard species combinations with low indicator values by setting thresholds for components A and B (in our example using <code>At=0.5</code> and <code>Bt=0.2</code>). The parameter <code>verbose = TRUE</code> allowed us to obtain information about the analysis process. Note that, by default, the <code><a href="../reference/indicators.html">indicators()</a></code> function will consider species combinations up to an order of 5 (i.e. <code>max.order = TRUE</code>). This can result in long computation times if the set of candidate species is not small. Similarly to <code><a href="../reference/multipatt.html">multipatt()</a></code>, we can print the results of <code><a href="../reference/indicators.html">indicators()</a></code> for the most useful indicators, using:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">sc</span>, sqrtIVt <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="co">#&gt;                              A         B    sqrtIV p.value</span>
<span class="co">#&gt; Phynod+Helind+Elesp. 1.0000000 0.5714286 0.7559289   0.005</span>
<span class="co">#&gt; Phynod+Elesp.        0.9000000 0.5714286 0.7171372   0.005</span>
<span class="co">#&gt; Phynod               0.6666667 0.7142857 0.6900656   0.005</span>
<span class="co">#&gt; Phynod+Helind        0.7142857 0.6428571 0.6776309   0.010</span>
<span class="co">#&gt; Helind+Elesp.        0.6428571 0.5714286 0.6060915   0.025</span>
<span class="co">#&gt; Melcor+Phynod+Elesp. 0.8571429 0.4285714 0.6060915   0.010</span>
<span class="co">#&gt; Melcor+Helind+Elesp. 0.8571429 0.4285714 0.6060915   0.010</span></code></pre></div>
<p>The species combinations are listed in decreasing indicator value order. Function <code><a href="../reference/indicators.html">indicators()</a></code> also calculates the statistical significance of indicator combinations, by making an internal call to <code><a href="../reference/signassoc.html">signassoc()</a></code>. In this case, we obtain that a combination of ‘Phynod’, ‘Helind’ and ‘Elesp.’ is even a better indicator than ‘Phynod’ and ‘Elesp.’. Note that the ‘A’ and IndVal values for the pair ‘Phynod’ and ‘Elesp.’ do not exactly match those obtained before. This is because <code><a href="../reference/indicators.html">indicators()</a></code> uses ‘IndVal’ and not ‘IndVal.g’ as default association statistic. In contrast to <code><a href="../reference/multipatt.html">multipatt()</a></code>, in <code><a href="../reference/indicators.html">indicators()</a></code> association statistics are restricted to ‘IndVal’ and ‘IndVal.g’.</p>
<p>Although we did not show it here, <code><a href="../reference/indicators.html">indicators()</a></code> can be run with the option requesting for bootstrap confidence intervals (using option <code>nboot.ci</code>). This allow us to know the reliability of the indicator value estimates, which is specially important for site groups of small size <span class="citation">(De Cáceres et al. 2012)</span>.</p>
</div>
<div id="determining-the-coverage-for-objects-of-class-indicators" class="section level3">
<h3 class="hasAnchor">
<a href="#determining-the-coverage-for-objects-of-class-indicators" class="anchor"></a>Determining the coverage for objects of class <code>indicators()</code>
</h3>
<p>We can determine the proportion of sites of the target site group where one or another indicator is found, using, as shown before for objects of class <code><a href="../reference/multipatt.html">multipatt()</a></code>, the function <code><a href="../reference/coverage.html">coverage()</a></code>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/coverage.html">coverage</a></span><span class="op">(</span><span class="va">sc</span><span class="op">)</span>
<span class="co">#&gt; [1] 1</span></code></pre></div>
<p>In this case the coverage was complete (i.e. 100%). Like we did for objects of class <code><a href="../reference/multipatt.html">multipatt()</a></code>, we can add requirements to the validity of indicators. For example:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/coverage.html">coverage</a></span><span class="op">(</span><span class="va">sc</span>, At<span class="op">=</span><span class="fl">0.8</span>, alpha <span class="op">=</span><span class="fl">0.05</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.9285714</span></code></pre></div>
<p>While we do not show here, in the case of objects of class <code><a href="../reference/indicators.html">indicators()</a></code> we recommend to explore the coverage using the lower boundary of confidence intervals, using option <code>type</code> of function <code><a href="../reference/coverage.html">coverage()</a></code>.</p>
<p>Finally, we can also plot coverage values corresponding to different thresholds:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/coverage.html">plotcoverage</a></span><span class="op">(</span><span class="va">sc</span><span class="op">)</span>
<span class="fu"><a href="../reference/coverage.html">plotcoverage</a></span><span class="op">(</span><span class="va">sc</span>, max.order<span class="op">=</span><span class="fl">1</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">0.1</span>, y<span class="op">=</span><span class="fl">20</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species combinations"</span>,<span class="st">"Species singletons"</span><span class="op">)</span>, 
       lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="IndicatorSpeciesAnalysis_files/figure-html/unnamed-chunk-31-1.png" width="480"></p>
<p>The coverage plot tells us that if we want to use a very large `A’ threshold (i.e., if we want to be very strict to select valid indicators), we won’t have enough valid indicators to cover all the area of our target site group. This limitation is more severe if only single species are considered.</p>
</div>
<div id="the-function-pruneindicators" class="section level3">
<h3 class="hasAnchor">
<a href="#the-function-pruneindicators" class="anchor"></a>The function <code>pruneindicators()</code>
</h3>
<p>As there may be many species combinations that could be used as indicators, the function <code><a href="../reference/pruneindicators.html">pruneindicators()</a></code> helps us to reduce the possibilities. First, the function selects those indicators (species or species combinations) that are valid according to the input thresholds <code>At</code>, <code>Bt</code> and <code>alpha</code>. Second, the function discards those valid indicators whose occurrence patterns are nested within other valid indicators. Third, the function evaluates the coverage of the remaining set of indicators. Finally, it explores subsets of increasing number of indicators, until the same coverage as the coverage of the complete set is attained and the subset of indicators is returned.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sc2</span><span class="op">=</span><span class="fu"><a href="../reference/pruneindicators.html">pruneindicators</a></span><span class="op">(</span><span class="va">sc</span>, At<span class="op">=</span><span class="fl">0.8</span>, Bt<span class="op">=</span><span class="fl">0.2</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Coverage of initial set of 73 indicators: 100%</span>
<span class="co">#&gt; Coverage of valid set of 31 indicators: 92.9%</span>
<span class="co">#&gt; Coverage of valid set of 7 nonnested indicators: 92.9%</span>
<span class="co">#&gt; Checking 7 subsets of 1 indicator(s) maximum coverage: 57.1%</span>
<span class="co">#&gt; Checking 21 subsets of 2 indicator(s).......... maximum coverage: 85.7%</span>
<span class="co">#&gt; Checking 35 subsets of 3 indicator(s)........ maximum coverage: 92.9%</span>
<span class="co">#&gt; Coverage of final set of 3 indicators: 92.9%</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">sc2</span><span class="op">)</span>
<span class="co">#&gt;                       A         B    sqrtIV p.value</span>
<span class="co">#&gt; Phynod+Elesp. 0.9000000 0.5714286 0.7171372   0.005</span>
<span class="co">#&gt; Cyprot        0.8666667 0.2857143 0.4976134   0.015</span>
<span class="co">#&gt; Echpas+Phynod 0.8000000 0.2857143 0.4780914   0.040</span></code></pre></div>
<p>In our example, and using these thresholds, the best indicators for group ‘2’ would be: (a) the combination of ‘Phynod’ and ‘Elesp.’; (b) ‘Cyprot’ and (c) ‘Echpas’ and ‘Phynod’. The three indicators together cover 93% of the sites belonging to the target site group.</p>
</div>
<div id="the-function-predict-indicators" class="section level3">
<h3 class="hasAnchor">
<a href="#the-function-predict-indicators" class="anchor"></a>The function <code>predict.indicators()</code>
</h3>
<p>The function <code><a href="../reference/indicators.html">indicators()</a></code> provides a model that can be used to predict a target site group. Once a given combination of species has been found, the corresponding ‘A’ value is an estimate of the probability of being in the target site group given the combination of species has been found. Therefore, the set of indicators could be used to predict the likelihood of the target site group in a new data set. The function <code><a href="../reference/predict.indicators.html">predict.indicators()</a></code> has exactly this role. It takes the results of <code><a href="../reference/indicators.html">indicators()</a></code> and a new community data matrix as input. Given this input, the function calculates the probability of the target site group for each site. The following code exemplifies the use of <code><a href="../reference/predict.indicators.html">predict.indicators()</a></code> with the same data that was used for the calibration of the indicator model (a new community data matrix should be used in normal applications):</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">sc2</span>, <span class="va">wetland</span><span class="op">)</span></code></pre></div>
<p>Of course, this will return biased estimates, as the data set used to build the model is the same as the target data set for which probabilities are desired. The same would be obtained using:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">sc2</span><span class="op">)</span></code></pre></div>
<p>which uses the original data set storied in the <code><a href="../reference/indicators.html">indicators()</a></code> object. If we want to evaluate these probability estimates in a cross-validated fashion (i.e., excluding each target site for the calculation of positive predictive values and the probability of the target site group), we can use:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pcv</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">sc2</span>, cv<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>We can compare the probabilities (evaluated by resubstitution and cross-validation) with the original group memberships:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Group2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">wetkm</span><span class="op">$</span><span class="va">cluster</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span>, Prob <span class="op">=</span> <span class="va">p</span>, Prob_CV <span class="op">=</span> <span class="va">pcv</span><span class="op">)</span>
<span class="co">#&gt;    Group2      Prob   Prob_CV</span>
<span class="co">#&gt; 5       0 0.0000000 0.0000000</span>
<span class="co">#&gt; 8       0 0.0000000 0.0000000</span>
<span class="co">#&gt; 13      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 4       0 0.0000000 0.0000000</span>
<span class="co">#&gt; 17      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 3       0 0.0000000 0.0000000</span>
<span class="co">#&gt; 9       0 0.0000000 0.0000000</span>
<span class="co">#&gt; 21      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 16      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 14      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 2       0 0.0000000 0.0000000</span>
<span class="co">#&gt; 15      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 1       0 0.0000000 0.0000000</span>
<span class="co">#&gt; 7       0 0.0000000 0.0000000</span>
<span class="co">#&gt; 10      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 40      1 0.9000000 1.0000000</span>
<span class="co">#&gt; 23      1 0.0000000 0.0000000</span>
<span class="co">#&gt; 25      1 0.9000000 0.8888889</span>
<span class="co">#&gt; 22      1 0.8000000 0.7500000</span>
<span class="co">#&gt; 20      1 0.9000000 0.8888889</span>
<span class="co">#&gt; 6       1 0.9000000 0.8888889</span>
<span class="co">#&gt; 18      1 0.9000000 0.8888889</span>
<span class="co">#&gt; 12      1 0.9000000 0.8888889</span>
<span class="co">#&gt; 39      1 0.9000000 0.8888889</span>
<span class="co">#&gt; 19      1 0.9000000 0.8750000</span>
<span class="co">#&gt; 11      1 0.9000000 0.8888889</span>
<span class="co">#&gt; 30      0 0.8666667 0.8181818</span>
<span class="co">#&gt; 34      0 0.8666667 0.8333333</span>
<span class="co">#&gt; 28      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 31      0 0.8666667 0.8461538</span>
<span class="co">#&gt; 26      1 0.8666667 0.8181818</span>
<span class="co">#&gt; 29      1 0.8666667 0.9285714</span>
<span class="co">#&gt; 33      1 0.8666667 0.9285714</span>
<span class="co">#&gt; 24      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 36      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 37      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 41      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 27      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 32      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 35      0 0.0000000 0.0000000</span>
<span class="co">#&gt; 38      0 0.0000000 0.0000000</span></code></pre></div>
<p>Cross-validated probabilities will tend to be lower than probabilities evaluated by resubstitution for sites originally belonging to the target site group and higher for other sites.</p>
</div>
</div>
<div id="bibliography" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#bibliography" class="anchor"></a>Bibliography</h2>
<div id="refs" class="references">
<div id="ref-Borcard2011">
<p>Borcard, Daniel, François Gillet, and Pierre Legendre. 2011. <em>Numerical Ecology in R</em>. Use R! Springer Science, New York.</p>
</div>
<div id="ref-Bowman1987">
<p>Bowman, D. M. J. S., and B. A. Wilson. 1987. “Wetland Vegetation Pattern on the Adelaide River Flood Plain, Northern Territory, Australia.” <em>Proceedings of the Royal Society of Queensland</em> 97: 69–77.</p>
</div>
<div id="ref-Chytry2002a">
<p>Chytrý, Milan, Lubomı́r Tichý, Jason Holt, and Zoltán Botta-Dukát. 2002. “Determination of diagnostic species with statistical fidelity measures.” <em>Journal of Vegetation Science</em> 13 (1): 79–90.</p>
</div>
<div id="ref-DeCaceres2008">
<p>De Cáceres, Miquel, X. Font, and F. Oliva. 2008. “Assessing species diagnostic value in large data sets: A comparison between phi-coefficient and Ochiai index.” <em>Journal of Vegetation Science</em> 19 (6): 779–88.</p>
</div>
<div id="ref-DeCaceres2009">
<p>De Cáceres, Miquel, and Pierre Legendre. 2009. “Associations between species and groups of sites: indices and statistical inference.” <em>Ecology</em> 90 (12): 3566–74.</p>
</div>
<div id="ref-DeCaceres2010">
<p>De Cáceres, Miquel, Pierre Legendre, and Marco Moretti. 2010. “Improving indicator species analysis by combining groups of sites.” <em>Oikos</em> 119 (10): 1674–84.</p>
</div>
<div id="ref-DeCaceres2012">
<p>De Cáceres, Miquel, Pierre Legendre, Susan K. Wiser, and Lluı́s Brotons. 2012. “Using Species Combinations in Indicator Value Analyses.” <em>Methods in Ecology and Evolution</em>, in press.</p>
</div>
<div id="ref-Dufrene1997">
<p>Dufrêne, Marc, and Pierre Legendre. 1997. “Species assemblages and indicator species: the need for a flexible asymmetrical approach.” <em>Ecological Monographs</em> 67 (3): 345–66.</p>
</div>
<div id="ref-Legendre2012">
<p>Legendre, Pierre, and Louis Legendre. 2012. <em>Numerical Ecology</em>. 3rd English Edition. Elsevier Science BV, Amsterdam.</p>
</div>
<div id="ref-Tichy2006">
<p>Tichý, Lubomı́r, and Milan Chytrý. 2006. “Statistical determination of diagnostic species for site groups of unequal size.” <em>Journal of Vegetation Science</em> 17 (6): 809.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Miquel De Cáceres, Florian Jansen, Noah Dell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
