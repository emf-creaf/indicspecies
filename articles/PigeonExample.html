<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Usage of the niche metric functions (former 'resniche' package) • indicspecies</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Usage of the niche metric functions (former 'resniche' package)">
<meta property="og:description" content="indicspecies">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">indicspecies</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/IndicatorSpeciesAnalysis.html">Indicator Species Analysis using 'indicspecies'</a>
    </li>
    <li>
      <a href="../articles/PigeonExample.html">Usage of the niche metric functions (former 'resniche' package)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Usage of the niche metric functions (former
‘resniche’ package)</h1>
                        <h4 data-toc-skip class="author">Miquel De
Cáceres, CREAF</h4>
                        <h4 data-toc-skip class="author">Oriol Lapiedra,
CREAF</h4>
            
            <h4 data-toc-skip class="date">2023-07-20</h4>
      
      
      <div class="hidden name"><code>PigeonExample.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this document we show how to use the functions described in <span class="citation">De Cáceres et al. (2011)</span> by following an example
of dietary preferences in pigeons belonging to two populations (Moià and
Barcelona) in Catalonia (north east of Spain). We begin by loading the
library and the data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://emf-creaf.github.io/indicspecies/" class="external-link">indicspecies</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: permute</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pigeons</span><span class="op">)</span></span></code></pre></div>
<p>The data consists of three items: the resource use matrix for each
pigeon population and the matrix of dissimilarities between pairs of
resources (seeds).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "dfood"          "diet.barcelona" "diet.moia"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="resemblance-between-diet-resources">Resemblance between diet resources<a class="anchor" aria-label="anchor" href="#resemblance-between-diet-resources"></a>
</h2>
<p>Before starting any resource niche calculation, we can inspect the
matrix of dissimilarities between the <span class="math inline">\(r=6\)</span> resources, <span class="math inline">\(\mathbf{D}\)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfood</span></span>
<span><span class="co">#&gt;                Oats      Peas   Popcorn       Soy Sunflower</span></span>
<span><span class="co">#&gt; Peas      0.7029375                                        </span></span>
<span><span class="co">#&gt; Popcorn   0.3706196 0.5070959                              </span></span>
<span><span class="co">#&gt; Soy       0.7738801 0.6645980 0.8638219                    </span></span>
<span><span class="co">#&gt; Sunflower 0.7656489 0.9773428 0.8784905 0.8669801          </span></span>
<span><span class="co">#&gt; Wheat     0.3948828 0.5705974 0.2836482 0.7740283 1.0000000</span></span></code></pre></div>
<p>These can be summarized using a dendrogram. For example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="va">dfood</span>, method<span class="op">=</span><span class="st">"average"</span><span class="op">)</span>, h<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">""</span>, </span>
<span>     ylab<span class="op">=</span><span class="st">"Distance"</span>, main<span class="op">=</span><span class="st">""</span>, sub<span class="op">=</span><span class="st">""</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PigeonExample_files/figure-html/unnamed-chunk-4-1.png" width="480"></p>
<p>Some seeds are quite similar (e.g. popcorn, wheat or oats), whereas
sunflower differs substantially from all other resources.</p>
</div>
<div class="section level2">
<h2 id="resource-niche-analysis-at-the-population-level">Resource niche analysis at the population level<a class="anchor" aria-label="anchor" href="#resource-niche-analysis-at-the-population-level"></a>
</h2>
<div class="section level3">
<h3 id="resource-use-of-populations">Resource use of populations<a class="anchor" aria-label="anchor" href="#resource-use-of-populations"></a>
</h3>
<p>We begin by showing the resource use data for pigeons of Barcelona
and Moia, expressed as proportions (i.e., the vector <span class="math inline">\(\mathbf{f}\)</span> for each population):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diet.pop.barcelona</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">diet.barcelona</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diet.pop.barcelona</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">diet.pop.barcelona</span><span class="op">)</span>, dig<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Oats      Peas   Popcorn       Soy Sunflower     Wheat </span></span>
<span><span class="co">#&gt;     0.049     0.001     0.028     0.024     0.455     0.442</span></span>
<span><span class="va">diet.pop.moia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">diet.moia</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diet.pop.moia</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">diet.pop.moia</span><span class="op">)</span>, dig<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Oats      Peas   Popcorn       Soy Sunflower     Wheat </span></span>
<span><span class="co">#&gt;     0.002     0.018     0.091     0.045     0.054     0.791</span></span></code></pre></div>
<p>Whereas pigeons in Moià feed almost exclusively on wheat, those of
Barcelona combine wheat and sunflower seeds.</p>
</div>
<div class="section level3">
<h3 id="niche-breadth-in-populations">Niche breadth in populations<a class="anchor" aria-label="anchor" href="#niche-breadth-in-populations"></a>
</h3>
<p>We will determine the resource niche breadth of each of the two
populations as <span class="citation">De Cáceres et al.
(2011)</span>:</p>
<p><span class="math inline">\(B_{pop} =
(1/2)\sum_{j=1}^r\sum_{k=1}^r{f_jf_kd_{jk}}\)</span></p>
<p>We first conduct our calculations without taking into account the
resemblance between resources (which is equal to stating that <span class="math inline">\(d_{jk}=1\)</span> in all cases):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nichevar.html">nichevar</a></span><span class="op">(</span>P<span class="op">=</span><span class="va">diet.barcelona</span>, mode<span class="op">=</span><span class="st">"single"</span><span class="op">)</span></span>
<span><span class="co">#&gt;               B        LC        UC</span></span>
<span><span class="co">#&gt; Niche 0.2966578 0.2718886 0.3324859</span></span>
<span><span class="fu"><a href="../reference/nichevar.html">nichevar</a></span><span class="op">(</span>P<span class="op">=</span><span class="va">diet.moia</span>, mode<span class="op">=</span><span class="st">"single"</span><span class="op">)</span></span>
<span><span class="co">#&gt;               B        LC        UC</span></span>
<span><span class="co">#&gt; Niche 0.1807663 0.1024439 0.2614191</span></span></code></pre></div>
<p>In general, we can say that the niche breadth of the population in
Moià is smaller than the niche breadth of the population in Barcelona.
If we repeat the same calculations with the matrix of resource
resemblance, we realize that the niche breadth of both populations
becomes smaller:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">popvar.barcelona</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nichevar.html">nichevar</a></span><span class="op">(</span>P<span class="op">=</span><span class="va">diet.barcelona</span>, D<span class="op">=</span><span class="va">dfood</span>, </span>
<span>                            mode<span class="op">=</span><span class="st">"single"</span><span class="op">)</span></span>
<span><span class="va">popvar.barcelona</span></span>
<span><span class="co">#&gt;               B        LC        UC</span></span>
<span><span class="co">#&gt; Niche 0.2453822 0.2316797 0.2568152</span></span>
<span><span class="va">popvar.moia</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nichevar.html">nichevar</a></span><span class="op">(</span>P<span class="op">=</span><span class="va">diet.moia</span>, D<span class="op">=</span><span class="va">dfood</span>, mode<span class="op">=</span><span class="st">"single"</span><span class="op">)</span></span>
<span><span class="va">popvar.moia</span></span>
<span><span class="co">#&gt;               B         LC       UC</span></span>
<span><span class="co">#&gt; Niche 0.0853328 0.02766593 0.164521</span></span></code></pre></div>
<p>The reason is that the first analysis was assuming that all resources
were equally (and maximally) distinct, while the second analysis
accounts for the similarity between some resources. Moreover, note that
the niche breadth of Moià has decreased more than the niche breadth of
Barcelona. This reflects that the resources being used by pigeons of
Moià are more similar than the resources used by pigeons of
Barcelona.</p>
</div>
<div class="section level3">
<h3 id="overlap-between-populations">Overlap between populations<a class="anchor" aria-label="anchor" href="#overlap-between-populations"></a>
</h3>
<p>We can now calculate the niche overlap between the two pigeon
populations: <span class="math display">\[
O_{12} =
\frac{\sum_{j=1}^r\sum_{k=1}^r{f_{1j}f_{2k}(1-d_{jk}^2)}}{\sqrt{\sum_{j=1}^r\sum_{k=1}^r{f_{1j}f_{1k}(1-d_{jk}^2)}\sum_{j=1}^r\sum_{k=1}^r{f_{2j}f_{2k}(1-d_{jk}^2)}}}
\]</span> Using function <code><a href="../reference/nicheoverlap.html">nicheoverlap()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nicheoverlap.html">nicheoverlap</a></span><span class="op">(</span>P1<span class="op">=</span><span class="va">diet.barcelona</span>, P2<span class="op">=</span><span class="va">diet.moia</span>, mode<span class="op">=</span><span class="st">"single"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 O       LC        UC</span></span>
<span><span class="co">#&gt; Overlap 0.7419319 0.459837 0.9251725</span></span>
<span><span class="fu"><a href="../reference/nicheoverlap.html">nicheoverlap</a></span><span class="op">(</span>P1<span class="op">=</span><span class="va">diet.barcelona</span>, P2<span class="op">=</span><span class="va">diet.moia</span>, mode<span class="op">=</span><span class="st">"single"</span>, D <span class="op">=</span> <span class="va">dfood</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 O       LC        UC</span></span>
<span><span class="co">#&gt; Overlap 0.7912472 0.532986 0.9388605</span></span></code></pre></div>
<p>If we include the resemblance between resources, the degree of
overlap increases, for the same reason that we obtained smaller niche
breadth statistics when resemblances were included.</p>
</div>
</div>
<div class="section level2">
<h2 id="resource-niche-analysis-at-the-individual-level">Resource niche analysis at the individual level<a class="anchor" aria-label="anchor" href="#resource-niche-analysis-at-the-individual-level"></a>
</h2>
<p>In this section, we perform a resource niche analysis at individual
level. In particular, we are interested in assessing how much the
resource niche of individuals differs from that of their corresponding
population. For this, we need to calculate a measure of the degree of
individual specialization.</p>
<div class="section level3">
<h3 id="resource-use-of-individuals">Resource use of individuals<a class="anchor" aria-label="anchor" href="#resource-use-of-individuals"></a>
</h3>
<p>We begin by showing the resource use data for all 23 pigeons in the
sample from the Barcelona population, expressed as proportions (i.e.,
matrix <span class="math inline">\(\mathbf{F}\)</span> for
Barcelona):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">diet.barcelona</span>, <span class="fl">1</span>, FUN<span class="op">=</span><span class="st">"/"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">diet.barcelona</span><span class="op">)</span><span class="op">)</span>, dig<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Oats  Peas Popcorn   Soy Sunflower Wheat</span></span>
<span><span class="co">#&gt; 1  0.000 0.000   0.000 0.000     0.020 0.980</span></span>
<span><span class="co">#&gt; 2  0.000 0.000   0.000 0.000     1.000 0.000</span></span>
<span><span class="co">#&gt; 3  0.000 0.000   0.000 0.000     1.000 0.000</span></span>
<span><span class="co">#&gt; 4  0.025 0.000   0.153 0.000     0.000 0.822</span></span>
<span><span class="co">#&gt; 5  0.000 0.000   0.000 0.000     0.965 0.035</span></span>
<span><span class="co">#&gt; 6  0.000 0.023   0.136 0.000     0.648 0.193</span></span>
<span><span class="co">#&gt; 7  0.000 0.000   0.000 0.000     0.795 0.205</span></span>
<span><span class="co">#&gt; 8  0.042 0.000   0.000 0.000     0.000 0.958</span></span>
<span><span class="co">#&gt; 9  1.000 0.000   0.000 0.000     0.000 0.000</span></span>
<span><span class="co">#&gt; 10 0.014 0.000   0.000 0.000     0.014 0.973</span></span>
<span><span class="co">#&gt; 11 0.000 0.000   0.000 0.000     0.350 0.650</span></span>
<span><span class="co">#&gt; 12 0.000 0.000   0.000 0.000     0.047 0.953</span></span>
<span><span class="co">#&gt; 13 0.000 0.000   0.000 0.000     0.437 0.562</span></span>
<span><span class="co">#&gt; 14 0.000 0.000   0.000 0.000     0.389 0.611</span></span>
<span><span class="co">#&gt; 15 0.000 0.000   0.000 0.549     0.451 0.000</span></span>
<span><span class="co">#&gt; 16 0.000 0.000   0.000 0.000     0.913 0.087</span></span>
<span><span class="co">#&gt; 17 0.000 0.000   0.113 0.075     0.755 0.057</span></span>
<span><span class="co">#&gt; 18 0.000 0.000   0.043 0.000     0.743 0.214</span></span>
<span><span class="co">#&gt; 19 0.000 0.000   0.000 0.000     0.667 0.333</span></span>
<span><span class="co">#&gt; 20 0.000 0.000   0.000 0.000     0.367 0.633</span></span>
<span><span class="co">#&gt; 21 0.000 0.000   0.000 0.000     0.910 0.090</span></span>
<span><span class="co">#&gt; 22 0.000 0.000   0.019 0.019     0.786 0.175</span></span>
<span><span class="co">#&gt; 23 0.442 0.000   0.000 0.000     0.000 0.558</span></span></code></pre></div>
<p>We see that most individuals in Barcelona feed on either sunflower or
wheat, but there are some individuals (like pigeon 9) which prefer oats.
Now we display the resource use data for the 19 pigeons representing the
population in Moià (i.e., matrix <span class="math inline">\(\mathbf{F}\)</span> for Moià):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">diet.moia</span>, <span class="fl">1</span>, FUN<span class="op">=</span><span class="st">"/"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">diet.moia</span><span class="op">)</span><span class="op">)</span>, dig<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Oats  Peas Popcorn   Soy Sunflower Wheat</span></span>
<span><span class="co">#&gt; 1  0.000 0.000   0.000 0.324     0.000 0.676</span></span>
<span><span class="co">#&gt; 2  0.000 0.000   0.000 0.012     0.000 0.988</span></span>
<span><span class="co">#&gt; 3  0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span><span class="co">#&gt; 4  0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span><span class="co">#&gt; 5  0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span><span class="co">#&gt; 6  0.000 0.000   0.267 0.000     0.000 0.733</span></span>
<span><span class="co">#&gt; 7  0.000 0.000   0.319 0.000     0.000 0.681</span></span>
<span><span class="co">#&gt; 8  0.027 0.311   0.041 0.000     0.000 0.622</span></span>
<span><span class="co">#&gt; 9  0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span><span class="co">#&gt; 10 0.000 0.000   0.148 0.000     0.000 0.852</span></span>
<span><span class="co">#&gt; 11 0.000 0.000   0.200 0.000     0.000 0.800</span></span>
<span><span class="co">#&gt; 12 0.000 0.000   0.235 0.000     0.000 0.765</span></span>
<span><span class="co">#&gt; 13 0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span><span class="co">#&gt; 14 0.000 0.000   0.119 0.339     0.136 0.407</span></span>
<span><span class="co">#&gt; 15 0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span><span class="co">#&gt; 16 0.000 0.000   0.000 0.000     0.000 1.000</span></span>
<span><span class="co">#&gt; 17 0.000 0.000   0.430 0.000     0.000 0.570</span></span>
<span><span class="co">#&gt; 18 0.000 0.000   0.000 0.000     0.583 0.417</span></span>
<span><span class="co">#&gt; 19 0.000 0.000   0.000 0.000     1.000 0.000</span></span></code></pre></div>
<p>Many pigeons from Moià feed on wheat seeds almost exclusively, but
some of them have broader preferences.</p>
</div>
<div class="section level3">
<h3 id="measuring-the-degree-of-individual-specialisation">Measuring the degree of individual specialisation<a class="anchor" aria-label="anchor" href="#measuring-the-degree-of-individual-specialisation"></a>
</h3>
<p>We begin our resource niche analysis by calculating the niche breadth
of each individual in the population, <span class="math inline">\(B_i\)</span>: <span class="math display">\[
B_i = (1/2)\sum_{j=1}^r\sum_{k=1}^r{f_{ij}f_{ik}d_{jk}}
\]</span> We calculate the values for the individuals of both
populations:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indvar.barcelona</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nichevar.html">nichevar</a></span><span class="op">(</span>P<span class="op">=</span><span class="va">diet.barcelona</span>, D<span class="op">=</span><span class="va">dfood</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">indvar.barcelona</span><span class="op">)</span></span>
<span><span class="co">#&gt;        B          </span></span>
<span><span class="co">#&gt;  Min.   :0.00000  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.01755  </span></span>
<span><span class="co">#&gt;  Median :0.08153  </span></span>
<span><span class="co">#&gt;  Mean   :0.11168  </span></span>
<span><span class="co">#&gt;  3rd Qu.:0.19890  </span></span>
<span><span class="co">#&gt;  Max.   :0.24609</span></span>
<span><span class="va">indvar.moia</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nichevar.html">nichevar</a></span><span class="op">(</span>P<span class="op">=</span><span class="va">diet.moia</span>, D<span class="op">=</span><span class="va">dfood</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">indvar.moia</span><span class="op">)</span></span>
<span><span class="co">#&gt;        B          </span></span>
<span><span class="co">#&gt;  Min.   :0.00000  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.00000  </span></span>
<span><span class="co">#&gt;  Median :0.01015  </span></span>
<span><span class="co">#&gt;  Mean   :0.04031  </span></span>
<span><span class="co">#&gt;  3rd Qu.:0.01861  </span></span>
<span><span class="co">#&gt;  Max.   :0.24306</span></span></code></pre></div>
<p>Most individuals have niche breadths that are smaller than the niche
breadth of their corresponding population, although a few individuals in
Moià have niche breadths larger than the population value. A niche
breadth equal to zero indicates that only one resource is exploited.</p>
<p>We can compare the niche breadth values of the two populations using
a non-parametric test.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span><span class="va">indvar.barcelona</span><span class="op">$</span><span class="va">B</span>, <span class="va">indvar.moia</span><span class="op">$</span><span class="va">B</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in wilcox.test.default(indvar.barcelona$B, indvar.moia$B): cannot</span></span>
<span><span class="co">#&gt; compute exact p-value with ties</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wilcoxon rank sum test with continuity correction</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  indvar.barcelona$B and indvar.moia$B</span></span>
<span><span class="co">#&gt; W = 328, p-value = 0.005446</span></span>
<span><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
<p>The Wilcoxon test confirms that the niche breadth of pigeons in
Barcelona is generally higher than that of pigeons in Moià, as we saw at
the population level.</p>
<p>In order to calculate the degree of individual specialization, <span class="citation">Bolnick et al. (2002)</span> defined WIC/TNW, i.e. the
ratio between the within individual component (i.e. average niche width)
and the total niche width of the population. Similarly we define the
following specialization measure, that takes into account the
resemblance between resources: <span class="math display">\[
S_{pop} = \frac{\sum_{i=n}^n{B_i}/n}{B_{pop}}
\]</span> where <span class="math inline">\(B_i\)</span> is the niche
breadth of each individual, and <span class="math inline">\(B_{pop}\)</span> is the niche breadth of the
population. Note that it is possible that <span class="math inline">\(B_i\)</span> values can be larger than <span class="math inline">\(B_{pop}\)</span>. However, we do not expect the
average of <span class="math inline">\(B_i\)</span> values to be larger
than <span class="math inline">\(B_{pop}\)</span>. If we calculate <span class="math inline">\(S_{pop}\)</span> for the two populations we
have:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Spec.barcelona</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">indvar.barcelona</span><span class="op">$</span><span class="va">B</span><span class="op">)</span><span class="op">/</span><span class="va">popvar.barcelona</span><span class="op">$</span><span class="va">B</span></span>
<span><span class="va">Spec.barcelona</span></span>
<span><span class="co">#&gt; [1] 0.4551234</span></span>
<span><span class="va">Spec.moia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">indvar.moia</span><span class="op">$</span><span class="va">B</span><span class="op">)</span><span class="op">/</span><span class="va">popvar.moia</span><span class="op">$</span><span class="va">B</span></span>
<span><span class="va">Spec.moia</span></span>
<span><span class="co">#&gt; [1] 0.4723618</span></span></code></pre></div>
<p>Surprisingly, the degree of specialization in Moià seems slightly
higher than that in Barcelona. To see whether this holds statistically,
we can calculate the degree of specialization of each individual: <span class="math display">\[
S_i = \frac{B_i}{B_{pop}}
\]</span> which, in R, is:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Spec.ind.barcelona</span> <span class="op">&lt;-</span> <span class="va">indvar.barcelona</span><span class="op">$</span><span class="va">B</span><span class="op">/</span><span class="va">popvar.barcelona</span><span class="op">$</span><span class="va">B</span></span>
<span><span class="va">Spec.ind.moia</span> <span class="op">&lt;-</span> <span class="va">indvar.moia</span><span class="op">$</span><span class="va">B</span><span class="op">/</span><span class="va">popvar.moia</span><span class="op">$</span><span class="va">B</span></span></code></pre></div>
<p>Finally, we compare this two vectors in a Wilcoxon test:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span><span class="va">Spec.ind.barcelona</span>, <span class="va">Spec.ind.moia</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in wilcox.test.default(Spec.ind.barcelona, Spec.ind.moia): cannot</span></span>
<span><span class="co">#&gt; compute exact p-value with ties</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wilcoxon rank sum test with continuity correction</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  Spec.ind.barcelona and Spec.ind.moia</span></span>
<span><span class="co">#&gt; W = 277, p-value = 0.1392</span></span>
<span><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
<p>Which tells us that those differences in individual specialization
are not statistically significant.</p>
</div>
<div class="section level3">
<h3 id="measuring-the-degree-of-overlap-between-individuals">Measuring the degree of overlap between individuals<a class="anchor" aria-label="anchor" href="#measuring-the-degree-of-overlap-between-individuals"></a>
</h3>
<p>The idea of this section is to determine how much the niche of each
individual overlaps with the niche of other individuals in the
population. This can be done by calling function
<code><a href="../reference/nicheoverlap.html">nicheoverlap()</a></code> using <code>mode = "pairwise"</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">O.barcelona</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nicheoverlap.html">nicheoverlap</a></span><span class="op">(</span><span class="va">diet.barcelona</span>,D<span class="op">=</span><span class="va">dfood</span>, mode<span class="op">=</span><span class="st">"pairwise"</span><span class="op">)</span></span>
<span><span class="va">O.moia</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nicheoverlap.html">nicheoverlap</a></span><span class="op">(</span><span class="va">diet.moia</span>,D<span class="op">=</span><span class="va">dfood</span>, mode<span class="op">=</span><span class="st">"pairwise"</span><span class="op">)</span></span></code></pre></div>
<p>These calls to <code><a href="../reference/nicheoverlap.html">nicheoverlap()</a></code> return a symmetric square
matrix with as many rows and columns as individuals in the resource use
data frame. Each cell value in the symmetric matrix is the overlap
between two individuals of the population. Using these matrices we can
derive the average overlap in each population:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">O.barcelona</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">O.barcelona</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.6726374</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">O.moia</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">O.moia</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8438816</span></span></code></pre></div>
<p>We can also calculate the average overlap between each individual and
the remaining individuals in its population:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">O.barcelona.ind</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">O.barcelona</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">O.barcelona</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">O.barcelona.ind</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.5400  0.6028  0.6558  0.6726  0.7595  0.8055</span></span>
<span><span class="va">O.moia.ind</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">O.moia</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">O.moia</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">O.moia.ind</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt; 0.09157 0.89915 0.90649 0.84388 0.90965 0.91134</span></span></code></pre></div>
<p>We substracted one in the numerator and denominator in order to
exclude the target individual from the average (the overlap between a
resource niche and itself is always one). Apparently, the individuals in
Moià have a larger degree of overlap with individuals of their
population than individuals in Barcelona. A non-parametric test seems to
confirm this difference:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span><span class="va">O.barcelona.ind</span>, <span class="va">O.moia.ind</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in wilcox.test.default(O.barcelona.ind, O.moia.ind): cannot compute</span></span>
<span><span class="co">#&gt; exact p-value with ties</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wilcoxon rank sum test with continuity correction</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  O.barcelona.ind and O.moia.ind</span></span>
<span><span class="co">#&gt; W = 37, p-value = 4.549e-06</span></span>
<span><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bolnick2002" class="csl-entry">
Bolnick, Daniel I., Louie H. Yang, James a. Fordyce, Jeremy M. Davis,
and Richard Svanbäck. 2002. <span>“<span class="nocase">Measuring
individual-level resource specialization</span>.”</span>
<em>Ecology</em> 83 (10): 2936–41.
</div>
<div id="ref-DeCaceres2011" class="csl-entry">
De Cáceres, Miquel, Daniel Sol, Oriol Lapiedra, and Pierre Legendre.
2011. <span>“<span class="nocase">A framework for estimating niche
metrics using the resemblance between qualitative
resources</span>.”</span> <em>Oikos</em> 120 (February): 1341–50.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Miquel De Cáceres, Florian Jansen, Noah Dell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
